import"../chunks/CWj6FrbW.js";import{o as Jr,a as Yi,s as we}from"../chunks/CBHc2I-Z.js";import{L as ei,aA as Wi,aE as Vi,z as Qi,b as Gi,aF as ti,q as Qn,h as St,l as yn,d as Ur,a0 as C,aj as Xi,a5 as Ji,a6 as Zi,a7 as Ko,s as Br,k as zt,C as ni,r as $i,a8 as ri,i as oi,a9 as ea,aG as Nr,x as ii,a4 as ta,D as Yr,aH as Zr,aI as Fo,aJ as $r,au as na,aK as qo,aL as ra,aM as oa,w as ia,aN as aa,j as sa,aO as ua,o as ai,_ as Ke,aP as la,u as ca,p as fa,g as Ro,e as da,A as rt,I as ha,c as bn,f as dt,a as ve,F as ot,X as Ce,W as ue,aQ as va,aR as pa,Y as R,$ as K,V as xe,Z as te,av as Ve,aS as Gn,ah as Xn}from"../chunks/xpUVlYYH.js";import{d as gt}from"../chunks/CKPaqtM9.js";import{a as Bo,b as No,s as Jn,c as Yt,r as ga,d as ma}from"../chunks/C-_ssXes.js";import{i as nt,r as ya,p as Te,b as At}from"../chunks/JuW1Ovd6.js";const ba=[];function Hr(s,o=!1){return Zn(s,new Map,"",ba)}function Zn(s,o,i,u,f=null){if(typeof s=="object"&&s!==null){var v=o.get(s);if(v!==void 0)return v;if(s instanceof Map)return new Map(s);if(s instanceof Set)return new Set(s);if(ei(s)){var p=Array(s.length);o.set(s,p),f!==null&&o.set(f,p);for(var D=0;D<s.length;D+=1){var E=s[D];D in s&&(p[D]=Zn(E,o,i,u))}return p}if(Wi(s)===Vi){p={},o.set(s,p),f!==null&&o.set(f,p);for(var M in s)p[M]=Zn(s[M],o,i,u);return p}if(s instanceof Date)return structuredClone(s);if(typeof s.toJSON=="function")return Zn(s.toJSON(),o,i,u,s)}if(s instanceof EventTarget)return s;try{return structuredClone(s)}catch{return s}}function Lt(s,o){return o}function _a(s,o,i,u){for(var f=[],v=o.length,p=0;p<v;p++)oa(o[p].e,f,!0);var D=v>0&&f.length===0&&i!==null;if(D){var E=i.parentNode;ia(E),E.append(i),u.clear(),jt(s,o[0].prev,o[v-1].next)}aa(f,()=>{for(var M=0;M<v;M++){var A=o[M];D||(u.delete(A.k),jt(s,A.prev,A.next)),sa(A.e,!D)}})}function Ut(s,o,i,u,f,v=null){var p=s,D={flags:o,items:new Map,first:null},E=(o&ti)!==0;if(E){var M=s;p=St?Qn(yn(M)):M.appendChild(Qi())}St&&Ur();var A=null,F=!1,P=Xi(()=>{var Y=i();return ei(Y)?Y:Y==null?[]:ii(Y)});Gi(()=>{var Y=C(P),H=Y.length;if(F&&H===0)return;F=H===0;let Q=!1;if(St){var Z=Ji(p)===Zi;Z!==(H===0)&&(p=Ko(),Qn(p),Br(!1),Q=!0)}if(St){for(var G=null,j,z=0;z<H;z++){if(zt.nodeType===ni&&zt.data===$i){p=zt,Q=!0,Br(!1);break}var q=Y[z],B=u(q,z);j=si(zt,D,G,null,q,B,z,f,o,i),D.items.set(B,j),G=j}H>0&&Qn(Ko())}St||wa(Y,D,p,f,o,u,i),v!==null&&(H===0?A?ri(A):A=oi(()=>v(p)):A!==null&&ea(A,()=>{A=null})),Q&&Br(!0),C(P)}),St&&(p=zt)}function wa(s,o,i,u,f,v,p){var Ne,Re,Ue,ye;var D=(f&ra)!==0,E=(f&(Zr|$r))!==0,M=s.length,A=o.items,F=o.first,P=F,Y,H=null,Q,Z=[],G=[],j,z,q,B;if(D)for(B=0;B<M;B+=1)j=s[B],z=v(j,B),q=A.get(z),q!==void 0&&((Ne=q.a)==null||Ne.measure(),(Q??(Q=new Set)).add(q));for(B=0;B<M;B+=1){if(j=s[B],z=v(j,B),q=A.get(z),q===void 0){var W=P?P.e.nodes_start:i;H=si(W,o,H,H===null?o.first:H.next,j,z,B,u,f,p),A.set(z,H),Z=[],G=[],P=H.next;continue}if(E&&xa(q,j,B,f),(q.e.f&Nr)!==0&&(ri(q.e),D&&((Re=q.a)==null||Re.unfix(),(Q??(Q=new Set)).delete(q))),q!==P){if(Y!==void 0&&Y.has(q)){if(Z.length<G.length){var N=G[0],oe;H=N.prev;var he=Z[0],se=Z[Z.length-1];for(oe=0;oe<Z.length;oe+=1)Ho(Z[oe],N,i);for(oe=0;oe<G.length;oe+=1)Y.delete(G[oe]);jt(o,he.prev,se.next),jt(o,H,he),jt(o,se,N),P=N,H=se,B-=1,Z=[],G=[]}else Y.delete(q),Ho(q,P,i),jt(o,q.prev,q.next),jt(o,q,H===null?o.first:H.next),jt(o,H,q),H=q;continue}for(Z=[],G=[];P!==null&&P.k!==z;)(P.e.f&Nr)===0&&(Y??(Y=new Set)).add(P),G.push(P),P=P.next;if(P===null)continue;q=P}Z.push(q),H=q,P=q.next}if(P!==null||Y!==void 0){for(var me=Y===void 0?[]:ii(Y);P!==null;)(P.e.f&Nr)===0&&me.push(P),P=P.next;var Ee=me.length;if(Ee>0){var Fe=(f&ti)!==0&&M===0?i:null;if(D){for(B=0;B<Ee;B+=1)(Ue=me[B].a)==null||Ue.measure();for(B=0;B<Ee;B+=1)(ye=me[B].a)==null||ye.fix()}_a(o,me,Fe,A)}}D&&ta(()=>{var ce;if(Q!==void 0)for(q of Q)(ce=q.a)==null||ce.apply()}),Yr.first=o.first&&o.first.e,Yr.last=H&&H.e}function xa(s,o,i,u){(u&Zr)!==0&&Fo(s.v,o),(u&$r)!==0?Fo(s.i,i):s.i=i}function si(s,o,i,u,f,v,p,D,E,M){var A=(E&Zr)!==0,F=(E&ua)===0,P=A?F?na(f,!1,!1):qo(f):f,Y=(E&$r)===0?p:qo(p),H={i:Y,v:P,k:v,a:null,e:null,prev:i,next:u};try{return H.e=oi(()=>D(s,P,Y,M),St),H.e.prev=i&&i.e,H.e.next=u&&u.e,i===null?o.first=H:(i.next=H,i.e.next=H.e),u!==null&&(u.prev=H,u.e.prev=H.e),H}finally{}}function Ho(s,o,i){for(var u=s.next?s.next.e.nodes_start:i,f=o?o.e.nodes_start:i,v=s.e.nodes_start;v!==u;){var p=ai(v);f.before(v),v=p}}function jt(s,o,i){o===null?s.first=i:(o.next=i,o.e.next=i&&i.e),i!==null&&(i.prev=o,i.e.prev=o&&o.e)}function ka(s,o,i=!1,u=!1,f=!1){var v=s,p="";Ke(()=>{var D=Yr;if(p===(p=o()??"")){St&&Ur();return}if(D.nodes_start!==null&&(la(D.nodes_start,D.nodes_end),D.nodes_start=D.nodes_end=null),p!==""){if(St){zt.data;for(var E=Ur(),M=E;E!==null&&(E.nodeType!==ni||E.data!=="");)M=E,E=ai(E);if(E===null)throw ca(),fa;Ro(zt,M),v=Qn(E);return}var A=p+"";i?A=`<svg>${A}</svg>`:u&&(A=`<math>${A}</math>`);var F=da(A);if((i||u)&&(F=yn(F)),Ro(yn(F),F.lastChild),i||u)for(;yn(F);)v.before(yn(F));else v.before(F)}})}var Da=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var $n={exports:{}},Ta=$n.exports,zo;function Ea(){return zo||(zo=1,function(s,o){(function(i,u){s.exports=u()})(Ta,function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])})(e,t)},u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function f(e,t,n){for(var r,a=0,l=t.length;a<l;a++)!r&&a in t||((r=r||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var v=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Da,p=Object.keys,D=Array.isArray;function E(e,t){return typeof t!="object"||p(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||v.Promise||(v.Promise=Promise);var M=Object.getPrototypeOf,A={}.hasOwnProperty;function F(e,t){return A.call(e,t)}function P(e,t){typeof t=="function"&&(t=t(M(e))),(typeof Reflect>"u"?p:Reflect.ownKeys)(t).forEach(function(n){H(e,n,t[n])})}var Y=Object.defineProperty;function H(e,t,n,r){Y(e,t,E(n&&F(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Q(e){return{from:function(t){return e.prototype=Object.create(t.prototype),H(e.prototype,"constructor",e),{extend:P.bind(null,e.prototype)}}}}var Z=Object.getOwnPropertyDescriptor,G=[].slice;function j(e,t,n){return G.call(e,t,n)}function z(e,t){return t(e)}function q(e){if(!e)throw new Error("Assertion Failed")}function B(e){v.setImmediate?setImmediate(e):setTimeout(e,0)}function W(e,t){if(typeof t=="string"&&F(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,a=t.length;r<a;++r){var l=W(e,t[r]);n.push(l)}return n}var c=t.indexOf(".");if(c!==-1){var d=e[t.substr(0,c)];return d==null?void 0:W(d,t.substr(c+1))}}function N(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){q(typeof n!="string"&&"length"in n);for(var r=0,a=t.length;r<a;++r)N(e,t[r],n[r])}else{var l,c,d=t.indexOf(".");d!==-1?(l=t.substr(0,d),(c=t.substr(d+1))===""?n===void 0?D(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=n:N(d=!(d=e[l])||!F(e,l)?e[l]={}:d,c,n)):n===void 0?D(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function oe(e){var t,n={};for(t in e)F(e,t)&&(n[t]=e[t]);return n}var he=[].concat;function se(e){return he.apply([],e)}var Se="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return v[e]}),me=new Set(Se.map(function(e){return v[e]})),Ee=null;function Fe(e){return Ee=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=Ee.get(n);if(r)return r;if(D(n)){r=[],Ee.set(n,r);for(var a=0,l=n.length;a<l;++a)r.push(t(n[a]))}else if(me.has(n.constructor))r=n;else{var c,d=M(n);for(c in r=d===Object.prototype?{}:Object.create(d),Ee.set(n,r),n)F(n,c)&&(r[c]=t(n[c]))}return r}(e),Ee=null,e}var Ne={}.toString;function Re(e){return Ne.call(e).slice(8,-1)}var Ue=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ye=typeof Ue=="symbol"?function(e){var t;return e!=null&&(t=e[Ue])&&t.apply(e)}:function(){return null};function ce(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Be={};function je(e){var t,n,r,a;if(arguments.length===1){if(D(e))return e.slice();if(this===Be&&typeof e=="string")return[e];if(a=ye(e)){for(n=[];!(r=a.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Ye=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Oe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ft=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Oe),Qe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function We(e,t){this.name=e,this.message=t}function ht(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,a){return a.indexOf(n)===r}).join(`
`)}function at(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=ht(e,t)}function it(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=ht(e,this.failures)}Q(We).from(Error).extend({toString:function(){return this.name+": "+this.message}}),Q(at).from(We),Q(it).from(We);var ct=ft.reduce(function(e,t){return e[t]=t+"Error",e},{}),Wt=We,ie=ft.reduce(function(e,t){var n=t+"Error";function r(a,l){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(l?`
 `+l:""),this.inner=l||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Qe[t]||n,this.inner=null)}return Q(r).from(Wt),e[t]=r,e},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var Vt=Oe.reduce(function(e,t){return e[t+"Error"]=ie[t],e},{}),mt=ft.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ie[t]),e},{});function ke(){}function Mt(e){return e}function wn(e,t){return e==null||e===Mt?t:function(n){return t(e(n))}}function wt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function xn(e,t){return e===ke?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?wt(r,this.onsuccess):r),a&&(this.onerror=this.onerror?wt(a,this.onerror):a),l!==void 0?l:n}}function kn(e,t){return e===ke?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?wt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?wt(r,this.onerror):r)}}function Dn(e,t){return e===ke?t:function(n){var r=e.apply(this,arguments);E(n,r);var a=this.onsuccess,l=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?wt(a,this.onsuccess):a),l&&(this.onerror=this.onerror?wt(l,this.onerror):l),r===void 0?n===void 0?void 0:n:E(r,n)}}function ar(e,t){return e===ke?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function ae(e,t){return e===ke?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,a=arguments.length,l=new Array(a);a--;)l[a]=arguments[a];return n.then(function(){return t.apply(r,l)})}return t.apply(this,arguments)}}mt.ModifyError=at,mt.DexieError=We,mt.BulkError=it;var le=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _e(e){le=e}var Ge={},Pe=100,Se=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,M(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,M(t),e]}(),Oe=Se[0],ft=Se[1],Se=Se[2],ft=ft&&ft.then,Ie=Oe&&Oe.constructor,Qt=!!Se,Kt=function(e,t){xt.push([e,t]),Le&&(queueMicrotask(wi),Le=!1)},qe=!0,Le=!0,vt=[],Gt=[],Xt=Mt,pt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},ne=pt,xt=[],yt=0,Jt=[];function ee(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ne;if(typeof e!="function"){if(e!==Ge)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ur(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,a){try{a(function(l){if(r._state===null){if(l===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&Zt();l&&typeof l.then=="function"?n(r,function(d,g){l instanceof ee?l._then(d,g):l.then(d,g)}):(r._state=!0,r._value=l,oo(r)),c&&$t()}},ur.bind(null,r))}catch(l){ur(r,l)}}(this,e)}var sr={get:function(){var e=ne,t=On;function n(r,a){var l=this,c=!e.global&&(e!==ne||t!==On),d=c&&!Et(),g=new ee(function(y,w){lr(l,new ro(ao(r,e,c,d),ao(a,e,c,d),y,w,e))});return this._consoleTask&&(g._consoleTask=this._consoleTask),g}return n.prototype=Ge,n},set:function(e){H(this,"then",e&&e.prototype===Ge?sr:{get:function(){return e},set:sr.set})}};function ro(e,t,n,r,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=a}function ur(e,t){var n,r;Gt.push(t),e._state===null&&(n=e._lib&&Zt(),t=Xt(t),e._state=!1,e._value=t,r=e,vt.some(function(a){return a._value===r._value})||vt.push(r),oo(e),n&&$t())}function oo(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)lr(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),yt===0&&(++yt,Kt(function(){--yt==0&&cr()},[]))}function lr(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++yt,Kt(_i,[n,e,t])}else e._listeners.push(t)}function _i(e,t,n){try{var r,a=t._value;!t._state&&Gt.length&&(Gt=[]),r=le&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||Gt.indexOf(a)!==-1||function(l){for(var c=vt.length;c;)if(vt[--c]._value===l._value)return vt.splice(c,1)}(t),n.resolve(r)}catch(l){n.reject(l)}finally{--yt==0&&cr(),--n.psd.ref||n.psd.finalize()}}function wi(){Ft(pt,function(){Zt()&&$t()})}function Zt(){var e=qe;return Le=qe=!1,e}function $t(){var e,t,n;do for(;0<xt.length;)for(e=xt,xt=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<xt.length);Le=qe=!0}function cr(){var e=vt;vt=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=Jt.slice(0),n=t.length;n;)t[--n]()}function Sn(e){return new ee(Ge,!1,e)}function Me(e,t){var n=ne;return function(){var r=Zt(),a=ne;try{return Ot(n,!0),e.apply(this,arguments)}catch(l){t&&t(l)}finally{Ot(a,!1),r&&$t()}}}P(ee.prototype,{then:sr,_then:function(e,t){lr(this,new ro(null,null,e,t,ne))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:Sn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:Sn)(r)})},finally:function(e){return this.then(function(t){return ee.resolve(e()).then(function(){return t})},function(t){return ee.resolve(e()).then(function(){return Sn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new ee(function(r,a){var l=setTimeout(function(){return a(new ie.Timeout(t))},e);n.then(r,a).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&H(ee.prototype,Symbol.toStringTag,"Dexie.Promise"),pt.env=io(),P(ee,{all:function(){var e=je.apply(null,arguments).map(Cn);return new ee(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(a,l){return ee.resolve(a).then(function(c){e[l]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof ee?e:e&&typeof e.then=="function"?new ee(function(t,n){e.then(t,n)}):new ee(Ge,!0,e)},reject:Sn,race:function(){var e=je.apply(null,arguments).map(Cn);return new ee(function(t,n){e.map(function(r){return ee.resolve(r).then(t,n)})})},PSD:{get:function(){return ne},set:function(e){return ne=e}},totalEchoes:{get:function(){return On}},newPSD:Tt,usePSD:Ft,scheduler:{get:function(){return Kt},set:function(e){Kt=e}},rejectionMapper:{get:function(){return Xt},set:function(e){Xt=e}},follow:function(e,t){return new ee(function(n,r){return Tt(function(a,l){var c=ne;c.unhandleds=[],c.onunhandled=l,c.finalize=wt(function(){var d,g=this;d=function(){g.unhandleds.length===0?a():l(g.unhandleds[0])},Jt.push(function y(){d(),Jt.splice(Jt.indexOf(y),1)}),++yt,Kt(function(){--yt==0&&cr()},[])},c.finalize),e()},t,n,r)})}}),Ie&&(Ie.allSettled&&H(ee,"allSettled",function(){var e=je.apply(null,arguments).map(Cn);return new ee(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(a,l){return ee.resolve(a).then(function(c){return r[l]={status:"fulfilled",value:c}},function(c){return r[l]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),Ie.any&&typeof AggregateError<"u"&&H(ee,"any",function(){var e=je.apply(null,arguments).map(Cn);return new ee(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,a=new Array(r);e.forEach(function(l,c){return ee.resolve(l).then(function(d){return t(d)},function(d){a[c]=d,--r||n(new AggregateError(a))})})})}),Ie.withResolvers&&(ee.withResolvers=Ie.withResolvers));var Xe={awaits:0,echoes:0,id:0},xi=0,Tn=[],En=0,On=0,ki=0;function Tt(e,t,n,r){var a=ne,l=Object.create(a);return l.parent=a,l.ref=0,l.global=!1,l.id=++ki,pt.env,l.env=Qt?{Promise:ee,PromiseProp:{value:ee,configurable:!0,writable:!0},all:ee.all,race:ee.race,allSettled:ee.allSettled,any:ee.any,resolve:ee.resolve,reject:ee.reject}:{},t&&E(l,t),++a.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},r=Ft(l,e,n,r),l.ref===0&&l.finalize(),r}function en(){return Xe.id||(Xe.id=++xi),++Xe.awaits,Xe.echoes+=Pe,Xe.id}function Et(){return!!Xe.awaits&&(--Xe.awaits==0&&(Xe.id=0),Xe.echoes=Xe.awaits*Pe,!0)}function Cn(e){return Xe.echoes&&e&&e.constructor===Ie?(en(),e.then(function(t){return Et(),t},function(t){return Et(),He(t)})):e}function Di(){var e=Tn[Tn.length-1];Tn.pop(),Ot(e,!1)}function Ot(e,t){var n,r=ne;(t?!Xe.echoes||En++&&e===ne:!En||--En&&e===ne)||queueMicrotask(t?(function(a){++On,Xe.echoes&&--Xe.echoes!=0||(Xe.echoes=Xe.awaits=Xe.id=0),Tn.push(ne),Ot(a,!0)}).bind(null,e):Di),e!==ne&&(ne=e,r===pt&&(pt.env=io()),Qt&&(n=pt.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(v,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function io(){var e=v.Promise;return Qt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(v,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ft(e,t,n,r,a){var l=ne;try{return Ot(e,!0),t(n,r,a)}finally{Ot(l,!1)}}function ao(e,t,n,r){return typeof e!="function"?e:function(){var a=ne;n&&en(),Ot(t,!0);try{return e.apply(this,arguments)}finally{Ot(a,!1),r&&queueMicrotask(Et)}}}function fr(e){Promise===Ie&&Xe.echoes===0?En===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+ft).indexOf("[native code]")===-1&&(en=Et=ke);var He=ee.reject,qt="ï¿¿",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",so="String expected.",tn=[],Pn="__dbnames",dr="readonly",hr="readwrite";function Rt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var uo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function In(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Fe(t))[e],t}}function lo(){throw ie.Type()}function be(e,t){try{var n=co(e),r=co(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,l){for(var c=a.length,d=l.length,g=c<d?c:d,y=0;y<g;++y)if(a[y]!==l[y])return a[y]<l[y]?-1:1;return c===d?0:c<d?-1:1}(fo(e),fo(t));case"Array":return function(a,l){for(var c=a.length,d=l.length,g=c<d?c:d,y=0;y<g;++y){var w=be(a[y],l[y]);if(w!==0)return w}return c===d?0:c<d?-1:1}(e,t)}}catch{}return NaN}function co(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Re(e),e==="ArrayBuffer"?"binary":e)}function fo(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ho=(Ae.prototype._trans=function(e,t,n){var r=this._tx||ne.trans,a=this.name,l=le&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(y,w,h){if(!h.schema[a])throw new ie.NotFound("Table "+a+" not part of transaction");return t(h.idbtrans,h)}var d=Zt();try{var g=r&&r.db._novip===this.db._novip?r===ne.trans?r._promise(e,c,n):Tt(function(){return r._promise(e,c,n)},{trans:r,transless:ne.transless||ne}):function y(w,h,k,m){if(w.idbdb&&(w._state.openComplete||ne.letThrough||w._vip)){var _=w._createTransaction(h,k,w._dbSchema);try{_.create(),w._state.PR1398_maxLoop=3}catch(x){return x.name===ct.InvalidState&&w.isOpen()&&0<--w._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),w.close({disableAutoOpen:!1}),w.open().then(function(){return y(w,h,k,m)})):He(x)}return _._promise(h,function(x,b){return Tt(function(){return ne.trans=_,m(x,b,_)})}).then(function(x){if(h==="readwrite")try{_.idbtrans.commit()}catch{}return h==="readonly"?x:_._completion.then(function(){return x})})}if(w._state.openComplete)return He(new ie.DatabaseClosed(w._state.dbOpenError));if(!w._state.isBeingOpened){if(!w._state.autoOpen)return He(new ie.DatabaseClosed);w.open().catch(ke)}return w._state.dbReadyPromise.then(function(){return y(w,h,k,m)})}(this.db,e,[this.name],c);return l&&(g._consoleTask=l,g=g.catch(function(y){return console.trace(y),He(y)})),g}finally{d&&$t()}},Ae.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?He(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},Ae.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(D(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=p(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(d){if(d.compound&&t.every(function(y){return 0<=d.keyPath.indexOf(y)})){for(var g=0;g<t.length;++g)if(t.indexOf(d.keyPath[g])===-1)return!1;return!0}return!1}).sort(function(d,g){return d.keyPath.length-g.keyPath.length})[0];if(n&&this.db._maxKey!==qt){var l=n.keyPath.slice(0,t.length);return this.where(l).equals(l.map(function(g){return e[g]}))}!n&&le&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function a(d,g){return be(d,g)===0}var c=t.reduce(function(h,g){var y=h[0],w=h[1],h=r[g],k=e[g];return[y||h,y||!h?Rt(w,h&&h.multi?function(m){return m=W(m,g),D(m)&&m.some(function(_){return a(k,_)})}:function(m){return a(k,W(m,g))}):w]},[null,null]),l=c[0],c=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},Ae.prototype.filter=function(e){return this.toCollection().and(e)},Ae.prototype.count=function(e){return this.toCollection().count(e)},Ae.prototype.offset=function(e){return this.toCollection().offset(e)},Ae.prototype.limit=function(e){return this.toCollection().limit(e)},Ae.prototype.each=function(e){return this.toCollection().each(e)},Ae.prototype.toArray=function(e){return this.toCollection().toArray(e)},Ae.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ae.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,D(e)?"[".concat(e.join("+"),"]"):e))},Ae.prototype.reverse=function(){return this.toCollection().reverse()},Ae.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof lo&&(function(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function w(){this.constructor=g}i(g,y),g.prototype=y===null?Object.create(y):(w.prototype=y.prototype,new w)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return r},e=a);for(var l=new Set,c=e.prototype;c;c=M(c))Object.getOwnPropertyNames(c).forEach(function(g){return l.add(g)});function d(g){if(!g)return g;var y,w=Object.create(e.prototype);for(y in g)if(!l.has(y))try{w[y]=g[y]}catch{}return w}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),e},Ae.prototype.defineClass=function(){return this.mapToClass(function(e){E(this,e)})},Ae.prototype.add=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,l=r.keyPath,c=e;return l&&a&&(c=In(l)(e)),this._trans("readwrite",function(d){return n.core.mutate({trans:d,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(d){return d.numFailures?ee.reject(d.failures[0]):d.lastResult}).then(function(d){if(l)try{N(e,l,d)}catch{}return d})},Ae.prototype.update=function(e,t){return typeof e!="object"||D(e)?this.where(":id").equals(e).modify(t):(e=W(e,this.schema.primKey.keyPath),e===void 0?He(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Ae.prototype.put=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,l=r.keyPath,c=e;return l&&a&&(c=In(l)(e)),this._trans("readwrite",function(d){return n.core.mutate({trans:d,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(d){return d.numFailures?ee.reject(d.failures[0]):d.lastResult}).then(function(d){if(l)try{N(e,l,d)}catch{}return d})},Ae.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?ee.reject(n.failures[0]):void 0})},Ae.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:uo})}).then(function(t){return t.numFailures?ee.reject(t.failures[0]):void 0})},Ae.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(a){return t.hook.reading.fire(a)})})})},Ae.prototype.bulkAdd=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,l=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var y=r.schema.primKey,d=y.auto,y=y.keyPath;if(y&&a)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&d?e.map(In(y)):e;return r.core.mutate({trans:c,type:"add",keys:a,values:y,wantResults:l}).then(function(_){var h=_.numFailures,k=_.results,m=_.lastResult,_=_.failures;if(h===0)return l?k:m;throw new it("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(g," operations failed"),_)})})},Ae.prototype.bulkPut=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,l=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var y=r.schema.primKey,d=y.auto,y=y.keyPath;if(y&&a)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&d?e.map(In(y)):e;return r.core.mutate({trans:c,type:"put",keys:a,values:y,wantResults:l}).then(function(_){var h=_.numFailures,k=_.results,m=_.lastResult,_=_.failures;if(h===0)return l?k:m;throw new it("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(g," operations failed"),_)})})},Ae.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),a=e.map(function(c){return c.changes}),l=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(d){var g=[],y=[];e.forEach(function(h,k){var m=h.key,_=h.changes,x=d[k];if(x){for(var b=0,S=Object.keys(_);b<S.length;b++){var T=S[b],O=_[T];if(T===t.schema.primKey.keyPath){if(be(O,m)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else N(x,T,O)}l.push(k),g.push(m),y.push(x)}});var w=g.length;return n.mutate({trans:c,type:"put",keys:g,values:y,updates:{keys:r,changeSpecs:a}}).then(function(h){var k=h.numFailures,m=h.failures;if(k===0)return w;for(var _=0,x=Object.keys(m);_<x.length;_++){var b,S=x[_],T=l[Number(S)];T!=null&&(b=m[S],delete m[S],m[T]=b)}throw new it("".concat(t.name,".bulkUpdate(): ").concat(k," of ").concat(w," operations failed"),m)})})})},Ae.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e})}).then(function(c){var a=c.numFailures,l=c.lastResult,c=c.failures;if(a===0)return l;throw new it("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),c)})},Ae);function Ae(){}function sn(e){function t(c,d){if(d){for(var g=arguments.length,y=new Array(g-1);--g;)y[g-1]=arguments[g];return n[c].subscribe.apply(null,y),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=l;for(var r=1,a=arguments.length;r<a;++r)l(arguments[r]);return t;function l(c,d,g){if(typeof c!="object"){var y;d=d||ar;var w={subscribers:[],fire:g=g||ke,subscribe:function(h){w.subscribers.indexOf(h)===-1&&(w.subscribers.push(h),w.fire=d(w.fire,h))},unsubscribe:function(h){w.subscribers=w.subscribers.filter(function(k){return k!==h}),w.fire=w.subscribers.reduce(d,g)}};return n[c]=t[c]=w}p(y=c).forEach(function(h){var k=y[h];if(D(k))l(h,y[h][0],y[h][1]);else{if(k!=="asap")throw new ie.InvalidArgument("Invalid event config");var m=l(h,Mt,function(){for(var _=arguments.length,x=new Array(_);_--;)x[_]=arguments[_];m.subscribers.forEach(function(b){B(function(){b.apply(null,x)})})})}})}}function un(e,t){return Q(t).from({prototype:e}),t}function nn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function vr(e,t){e.filter=Rt(e.filter,t)}function pr(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Rt(r(),t())}:t,e.justLimit=n&&!r}function jn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ie.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function vo(e,t,n){var r=jn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function An(e,t,n,r){var a=e.replayFilter?Rt(e.filter,e.replayFilter()):e.filter;if(e.or){var l={},c=function(d,g,y){var w,h;a&&!a(g,y,function(k){return g.stop(k)},function(k){return g.fail(k)})||((h=""+(w=g.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(w)),F(l,h)||(l[h]=!0,t(d,g,y)))};return Promise.all([e.or._iterate(c,n),po(vo(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return po(vo(e,r,n),Rt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function po(e,t,n,r){var a=Me(r?function(l,c,d){return n(r(l),c,d)}:n);return e.then(function(l){if(l)return l.start(function(){var c=function(){return l.continue()};t&&!t(l,function(d){return c=d},function(d){l.stop(d),c=ke},function(d){l.fail(d),c=ke})||a(l.value,l,function(d){return c=d}),c()})})}var ln=(go.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(D(n))return f(f([],D(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(D(r))return D(e)?e.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},go);function go(e){this["@@propmod"]=e}var Si=(De.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,He.bind(null,n.error)):n.table._trans("readonly",e).then(t)},De.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,He.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},De.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Rt(t.algorithm,e)},De.prototype._iterate=function(e,t){return An(this._ctx,e,t,this._ctx.table.core)},De.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&E(n,e),t._ctx=n,t},De.prototype.raw=function(){return this._ctx.valueMapper=null,this},De.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return An(t,e,n,t.table.core)})},De.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,a=r.table.core;if(nn(r,!0))return a.count({trans:n,query:{index:jn(r,a.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var l=0;return An(r,function(){return++l,!1},n,a).then(function(){return l})}).then(e)},De.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],a=n.length-1;function l(g,y){return y?l(g[n[y]],y-1):g[r]}var c=this._ctx.dir==="next"?1:-1;function d(g,y){return be(l(g,a),l(y,a))*c}return this.toArray(function(g){return g.sort(d)}).then(t)},De.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&nn(r,!0)&&0<r.limit){var a=r.valueMapper,l=jn(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:l,range:r.range}}).then(function(d){return d=d.result,a?d.map(a):d})}var c=[];return An(r,function(d){return c.push(d)},n,r.table.core).then(function(){return c})},e)},De.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,nn(t)?pr(t,function(){var n=e;return function(r,a){return n===0||(n===1?--n:a(function(){r.advance(n),n=0}),!1)}}):pr(t,function(){var n=e;return function(){return--n<0}})),this},De.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),pr(this._ctx,function(){var t=e;return function(n,r,a){return--t<=0&&r(a),0<=t}},!0),this},De.prototype.until=function(e,t){return vr(this._ctx,function(n,r,a){return!e(n.value)||(r(a),t)}),this},De.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},De.prototype.last=function(e){return this.reverse().first(e)},De.prototype.filter=function(e){var t;return vr(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Rt(t.isMatch,e),this},De.prototype.and=function(e){return this.filter(e)},De.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},De.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},De.prototype.desc=function(){return this.reverse()},De.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},De.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},De.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},De.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.key)}).then(function(){return n}).then(e)},De.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&nn(t,!0)&&0<t.limit)return this._read(function(r){var a=jn(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},De.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},De.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},De.prototype.lastKey=function(e){return this.reverse().firstKey(e)},De.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return vr(this._ctx,function(a){var r=a.primaryKey.toString(),a=F(t,r);return t[r]=!0,!a}),this},De.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var a,l,c;c=typeof e=="function"?e:(a=p(e),l=a.length,function(b){for(var S=!1,T=0;T<l;++T){var O=a[T],I=e[O],L=W(b,O);I instanceof ln?(N(b,O,I.execute(L)),S=!0):L!==I&&(N(b,O,I),S=!0)}return S});var d=n.table.core,h=d.schema.primaryKey,g=h.outbound,y=h.extractKey,w=200,h=t.db._options.modifyChunkSize;h&&(w=typeof h=="object"?h[d.name]||h["*"]||200:h);function k(b,O){var T=O.failures,O=O.numFailures;_+=b-O;for(var I=0,L=p(T);I<L.length;I++){var J=L[I];m.push(T[J])}}var m=[],_=0,x=[];return t.clone().primaryKeys().then(function(b){function S(O){var I=Math.min(w,b.length-O);return d.getMany({trans:r,keys:b.slice(O,O+I),cache:"immutable"}).then(function(L){for(var J=[],U=[],V=g?[]:null,$=[],X=0;X<I;++X){var re=L[X],de={value:Fe(re),primKey:b[O+X]};c.call(de,de.value,de)!==!1&&(de.value==null?$.push(b[O+X]):g||be(y(re),y(de.value))===0?(U.push(de.value),g&&V.push(b[O+X])):($.push(b[O+X]),J.push(de.value)))}return Promise.resolve(0<J.length&&d.mutate({trans:r,type:"add",values:J}).then(function(pe){for(var ge in pe.failures)$.splice(parseInt(ge),1);k(J.length,pe)})).then(function(){return(0<U.length||T&&typeof e=="object")&&d.mutate({trans:r,type:"put",keys:V,values:U,criteria:T,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<O}).then(function(pe){return k(U.length,pe)})}).then(function(){return(0<$.length||T&&e===gr)&&d.mutate({trans:r,type:"delete",keys:$,criteria:T,isAdditionalChunk:0<O}).then(function(pe){return k($.length,pe)})}).then(function(){return b.length>O+I&&S(O+w)})})}var T=nn(n)&&n.limit===1/0&&(typeof e!="function"||e===gr)&&{index:n.index,range:n.range};return S(0).then(function(){if(0<m.length)throw new at("Error modifying one or more objects",m,_,x);return b.length})})})},De.prototype.delete=function(){var e=this._ctx,t=e.range;return nn(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var r=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:r,range:a}}).then(function(l){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(c){var d=c.failures;if(c.lastResult,c.results,c=c.numFailures,c)throw new at("Could not delete some values",Object.keys(d).map(function(g){return d[g]}),l-c);return l-c})})}):this.modify(gr)},De);function De(){}var gr=function(e,t){return t.value=null};function Ti(e,t){return e<t?-1:e===t?0:1}function Ei(e,t){return t<e?-1:e===t?0:1}function st(e,t,n){return e=e instanceof yo?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function rn(e){return new e.Collection(e,function(){return mo("")}).limit(0)}function Mn(e,t,n,r){var a,l,c,d,g,y,w,h=n.length;if(!n.every(function(_){return typeof _=="string"}))return st(e,so);function k(_){a=_==="next"?function(b){return b.toUpperCase()}:function(b){return b.toLowerCase()},l=_==="next"?function(b){return b.toLowerCase()}:function(b){return b.toUpperCase()},c=_==="next"?Ti:Ei;var x=n.map(function(b){return{lower:l(b),upper:a(b)}}).sort(function(b,S){return c(b.lower,S.lower)});d=x.map(function(b){return b.upper}),g=x.map(function(b){return b.lower}),w=(y=_)==="next"?"":r}k("next"),e=new e.Collection(e,function(){return Ct(d[0],g[h-1]+r)}),e._ondirectionchange=function(_){k(_)};var m=0;return e._addAlgorithm(function(_,x,b){var S=_.key;if(typeof S!="string")return!1;var T=l(S);if(t(T,g,m))return!0;for(var O=null,I=m;I<h;++I){var L=function(J,U,V,$,X,re){for(var de=Math.min(J.length,$.length),pe=-1,ge=0;ge<de;++ge){var ut=U[ge];if(ut!==$[ge])return X(J[ge],V[ge])<0?J.substr(0,ge)+V[ge]+V.substr(ge+1):X(J[ge],$[ge])<0?J.substr(0,ge)+$[ge]+V.substr(ge+1):0<=pe?J.substr(0,pe)+U[pe]+V.substr(pe+1):null;X(J[ge],ut)<0&&(pe=ge)}return de<$.length&&re==="next"?J+V.substr(J.length):de<J.length&&re==="prev"?J.substr(0,V.length):pe<0?null:J.substr(0,pe)+$[pe]+V.substr(pe+1)}(S,T,d[I],g[I],c,y);L===null&&O===null?m=I+1:(O===null||0<c(O,L))&&(O=L)}return x(O!==null?function(){_.continue(O+w)}:b),!1}),e}function Ct(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function mo(e){return{type:1,lower:e,upper:e}}var yo=(Object.defineProperty(Je.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Je.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?rn(this):new this.Collection(this,function(){return Ct(e,t,!n,!r)})}catch{return st(this,kt)}},Je.prototype.equals=function(e){return e==null?st(this,kt):new this.Collection(this,function(){return mo(e)})},Je.prototype.above=function(e){return e==null?st(this,kt):new this.Collection(this,function(){return Ct(e,void 0,!0)})},Je.prototype.aboveOrEqual=function(e){return e==null?st(this,kt):new this.Collection(this,function(){return Ct(e,void 0,!1)})},Je.prototype.below=function(e){return e==null?st(this,kt):new this.Collection(this,function(){return Ct(void 0,e,!1,!0)})},Je.prototype.belowOrEqual=function(e){return e==null?st(this,kt):new this.Collection(this,function(){return Ct(void 0,e)})},Je.prototype.startsWith=function(e){return typeof e!="string"?st(this,so):this.between(e,e+qt,!0,!0)},Je.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Mn(this,function(t,n){return t.indexOf(n[0])===0},[e],qt)},Je.prototype.equalsIgnoreCase=function(e){return Mn(this,function(t,n){return t===n[0]},[e],"")},Je.prototype.anyOfIgnoreCase=function(){var e=je.apply(Be,arguments);return e.length===0?rn(this):Mn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Je.prototype.startsWithAnyOfIgnoreCase=function(){var e=je.apply(Be,arguments);return e.length===0?rn(this):Mn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,qt)},Je.prototype.anyOf=function(){var e=this,t=je.apply(Be,arguments),n=this._cmp;try{t.sort(n)}catch{return st(this,kt)}if(t.length===0)return rn(this);var r=new this.Collection(this,function(){return Ct(t[0],t[t.length-1])});r._ondirectionchange=function(l){n=l==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return r._addAlgorithm(function(l,c,d){for(var g=l.key;0<n(g,t[a]);)if(++a===t.length)return c(d),!1;return n(g,t[a])===0||(c(function(){l.continue(t[a])}),!1)}),r},Je.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Je.prototype.noneOf=function(){var e=je.apply(Be,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return st(this,kt)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Je.prototype.inAnyRange=function(S,t){var n=this,r=this._cmp,a=this._ascending,l=this._descending,c=this._min,d=this._max;if(S.length===0)return rn(this);if(!S.every(function(T){return T[0]!==void 0&&T[1]!==void 0&&a(T[0],T[1])<=0}))return st(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var g=!t||t.includeLowers!==!1,y=t&&t.includeUppers===!0,w,h=a;function k(T,O){return h(T[0],O[0])}try{(w=S.reduce(function(T,O){for(var I=0,L=T.length;I<L;++I){var J=T[I];if(r(O[0],J[1])<0&&0<r(O[1],J[0])){J[0]=c(J[0],O[0]),J[1]=d(J[1],O[1]);break}}return I===L&&T.push(O),T},[])).sort(k)}catch{return st(this,kt)}var m=0,_=y?function(T){return 0<a(T,w[m][1])}:function(T){return 0<=a(T,w[m][1])},x=g?function(T){return 0<l(T,w[m][0])}:function(T){return 0<=l(T,w[m][0])},b=_,S=new this.Collection(this,function(){return Ct(w[0][0],w[w.length-1][1],!g,!y)});return S._ondirectionchange=function(T){h=T==="next"?(b=_,a):(b=x,l),w.sort(k)},S._addAlgorithm(function(T,O,I){for(var L,J=T.key;b(J);)if(++m===w.length)return O(I),!1;return!_(L=J)&&!x(L)||(n._cmp(J,w[m][1])===0||n._cmp(J,w[m][0])===0||O(function(){h===a?T.continue(w[m][0]):T.continue(w[m][1])}),!1)}),S},Je.prototype.startsWithAnyOf=function(){var e=je.apply(Be,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?rn(this):this.inAnyRange(e.map(function(t){return[t,t+qt]})):st(this,"startsWithAnyOf() only works with strings")},Je);function Je(){}function bt(e){return Me(function(t){return cn(t),e(t.target.error),!1})}function cn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var fn="storagemutated",mr="x-storagemutated-1",Pt=sn(null,fn),Oi=(_t.prototype._lock=function(){return q(!ne.global),++this._reculock,this._reculock!==1||ne.global||(ne.lockOwnerFor=this),this},_t.prototype._unlock=function(){if(q(!ne.global),--this._reculock==0)for(ne.global||(ne.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ft(e[1],e[0])}catch{}}return this},_t.prototype._locked=function(){return this._reculock&&ne.lockOwnerFor!==this},_t.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(q(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(r);case"MissingAPIError":throw new ie.MissingAPI(r.message,r);default:throw new ie.OpenFailed(r)}if(!this.active)throw new ie.TransactionInactive;return q(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Me(function(a){cn(a),t._reject(e.error)}),e.onabort=Me(function(a){cn(a),t.active&&t._reject(new ie.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=Me(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Pt.storagemutated.fire(e.mutatedParts)}),this},_t.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return He(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return He(new ie.TransactionInactive);if(this._locked())return new ee(function(l,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(l,c)},ne])});if(n)return Tt(function(){var l=new ee(function(c,d){r._lock();var g=t(c,d,r);g&&g.then&&g.then(c,d)});return l.finally(function(){return r._unlock()}),l._lib=!0,l});var a=new ee(function(l,c){var d=t(l,c,r);d&&d.then&&d.then(l,c)});return a._lib=!0,a},_t.prototype._root=function(){return this.parent?this.parent._root():this},_t.prototype.waitFor=function(e){var t,n=this._root(),r=ee.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function l(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=l)}());var a=n._waitingFor;return new ee(function(l,c){r.then(function(d){return n._waitingQueue.push(Me(l.bind(null,d)))},function(d){return n._waitingQueue.push(Me(c.bind(null,d)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},_t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},_t.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(F(t,e))return t[e];var n=this.schema[e];if(!n)throw new ie.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},_t);function _t(){}function yr(e,t,n,r,a,l,c){return{name:e,keyPath:t,unique:n,multi:r,auto:a,compound:l,src:(n&&!c?"&":"")+(r?"*":"")+(a?"++":"")+bo(t)}}function bo(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function br(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(a){return[a.name,a]},n.reduce(function(a,l,c){return c=r(l,c),c&&(a[c[0]]=c[1]),a},{}))};var r}var dn=function(e){try{return e.only([[]]),dn=function(){return[[]]},[[]]}catch{return dn=function(){return qt},qt}};function _r(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return W(n,t)}:function(n){return W(n,e)};var t}function _o(e){return[].slice.call(e)}var Ci=0;function hn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Pi(e,t,g){function r(b){if(b.type===3)return null;if(b.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var m=b.lower,_=b.upper,x=b.lowerOpen,b=b.upperOpen;return m===void 0?_===void 0?null:t.upperBound(_,!!b):_===void 0?t.lowerBound(m,!!x):t.bound(m,_,!!x,!!b)}function a(k){var m,_=k.name;return{name:_,schema:k,mutate:function(x){var b=x.trans,S=x.type,T=x.keys,O=x.values,I=x.range;return new Promise(function(L,J){L=Me(L);var U=b.objectStore(_),V=U.keyPath==null,$=S==="put"||S==="add";if(!$&&S!=="delete"&&S!=="deleteRange")throw new Error("Invalid operation type: "+S);var X,re=(T||O||{length:1}).length;if(T&&O&&T.length!==O.length)throw new Error("Given keys array must have same length as given values array.");if(re===0)return L({numFailures:0,failures:{},results:[],lastResult:void 0});function de(tt){++ut,cn(tt)}var pe=[],ge=[],ut=0;if(S==="deleteRange"){if(I.type===4)return L({numFailures:ut,failures:ge,results:[],lastResult:void 0});I.type===3?pe.push(X=U.clear()):pe.push(X=U.delete(r(I)))}else{var V=$?V?[O,T]:[O,null]:[T,null],fe=V[0],$e=V[1];if($)for(var et=0;et<re;++et)pe.push(X=$e&&$e[et]!==void 0?U[S](fe[et],$e[et]):U[S](fe[et])),X.onerror=de;else for(et=0;et<re;++et)pe.push(X=U[S](fe[et])),X.onerror=de}function Vn(tt){tt=tt.target.result,pe.forEach(function(Ht,Rr){return Ht.error!=null&&(ge[Rr]=Ht.error)}),L({numFailures:ut,failures:ge,results:S==="delete"?T:pe.map(function(Ht){return Ht.result}),lastResult:tt})}X.onerror=function(tt){de(tt),Vn(tt)},X.onsuccess=Vn})},getMany:function(x){var b=x.trans,S=x.keys;return new Promise(function(T,O){T=Me(T);for(var I,L=b.objectStore(_),J=S.length,U=new Array(J),V=0,$=0,X=function(pe){pe=pe.target,U[pe._pos]=pe.result,++$===V&&T(U)},re=bt(O),de=0;de<J;++de)S[de]!=null&&((I=L.get(S[de]))._pos=de,I.onsuccess=X,I.onerror=re,++V);V===0&&T(U)})},get:function(x){var b=x.trans,S=x.key;return new Promise(function(T,O){T=Me(T);var I=b.objectStore(_).get(S);I.onsuccess=function(L){return T(L.target.result)},I.onerror=bt(O)})},query:(m=y,function(x){return new Promise(function(b,S){b=Me(b);var T,O,I,V=x.trans,L=x.values,J=x.limit,X=x.query,U=J===1/0?void 0:J,$=X.index,X=X.range,V=V.objectStore(_),$=$.isPrimaryKey?V:V.index($.name),X=r(X);if(J===0)return b({result:[]});m?((U=L?$.getAll(X,U):$.getAllKeys(X,U)).onsuccess=function(re){return b({result:re.target.result})},U.onerror=bt(S)):(T=0,O=!L&&"openKeyCursor"in $?$.openKeyCursor(X):$.openCursor(X),I=[],O.onsuccess=function(re){var de=O.result;return de?(I.push(L?de.value:de.primaryKey),++T===J?b({result:I}):void de.continue()):b({result:I})},O.onerror=bt(S))})}),openCursor:function(x){var b=x.trans,S=x.values,T=x.query,O=x.reverse,I=x.unique;return new Promise(function(L,J){L=Me(L);var $=T.index,U=T.range,V=b.objectStore(_),V=$.isPrimaryKey?V:V.index($.name),$=O?I?"prevunique":"prev":I?"nextunique":"next",X=!S&&"openKeyCursor"in V?V.openKeyCursor(r(U),$):V.openCursor(r(U),$);X.onerror=bt(J),X.onsuccess=Me(function(re){var de,pe,ge,ut,fe=X.result;fe?(fe.___id=++Ci,fe.done=!1,de=fe.continue.bind(fe),pe=(pe=fe.continuePrimaryKey)&&pe.bind(fe),ge=fe.advance.bind(fe),ut=function(){throw new Error("Cursor not stopped")},fe.trans=b,fe.stop=fe.continue=fe.continuePrimaryKey=fe.advance=function(){throw new Error("Cursor not started")},fe.fail=Me(J),fe.next=function(){var $e=this,et=1;return this.start(function(){return et--?$e.continue():$e.stop()}).then(function(){return $e})},fe.start=function($e){function et(){if(X.result)try{$e()}catch(tt){fe.fail(tt)}else fe.done=!0,fe.start=function(){throw new Error("Cursor behind last entry")},fe.stop()}var Vn=new Promise(function(tt,Ht){tt=Me(tt),X.onerror=bt(Ht),fe.fail=Ht,fe.stop=function(Rr){fe.stop=fe.continue=fe.continuePrimaryKey=fe.advance=ut,tt(Rr)}});return X.onsuccess=Me(function(tt){X.onsuccess=et,et()}),fe.continue=de,fe.continuePrimaryKey=pe,fe.advance=ge,et(),Vn},L(fe)):L(null)},J)})},count:function(x){var b=x.query,S=x.trans,T=b.index,O=b.range;return new Promise(function(I,L){var J=S.objectStore(_),U=T.isPrimaryKey?J:J.index(T.name),J=r(O),U=J?U.count(J):U.count();U.onsuccess=Me(function(V){return I(V.target.result)}),U.onerror=bt(L)})}}}var l,c,d,w=(c=g,d=_o((l=e).objectStoreNames),{schema:{name:l.name,tables:d.map(function(k){return c.objectStore(k)}).map(function(k){var m=k.keyPath,b=k.autoIncrement,_=D(m),x={},b={name:k.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m==null,compound:_,keyPath:m,autoIncrement:b,unique:!0,extractKey:_r(m)},indexes:_o(k.indexNames).map(function(S){return k.index(S)}).map(function(I){var T=I.name,O=I.unique,L=I.multiEntry,I=I.keyPath,L={name:T,compound:D(I),keyPath:I,unique:O,multiEntry:L,extractKey:_r(I)};return x[hn(I)]=L}),getIndexByKeyPath:function(S){return x[hn(S)]}};return x[":id"]=b.primaryKey,m!=null&&(x[hn(m)]=b.primaryKey),b})},hasGetAll:0<d.length&&"getAll"in c.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),g=w.schema,y=w.hasGetAll,w=g.tables.map(a),h={};return w.forEach(function(k){return h[k.name]=k}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(k){if(!h[k])throw new Error("Table '".concat(k,"' not found"));return h[k]},MIN_KEY:-1/0,MAX_KEY:dn(t),schema:g}}function Ii(e,t,n,r){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Pi(t,a,r),e.dbcore.reduce(function(l,c){return c=c.create,u(u({},l),c(l))},r))}}function Kn(e,r){var n=r.db,r=Ii(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(a){var l=a.name;e.core.schema.tables.some(function(c){return c.name===l})&&(a.core=e.core.table(l),e[l]instanceof e.Table&&(e[l].core=a.core))})}function Fn(e,t,n,r){n.forEach(function(a){var l=r[a];t.forEach(function(c){var d=function g(y,w){return Z(y,w)||(y=M(y))&&g(y,w)}(c,a);(!d||"value"in d&&d.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?H(c,a,{get:function(){return this.table(a)},set:function(g){Y(this,a,{value:g,writable:!0,configurable:!0,enumerable:!0})}}):c[a]=new e.Table(a,l))})})}function wr(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function ji(e,t){return e._cfg.version-t._cfg.version}function Ai(e,t,n,r){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=br("$meta",xo("")[0],[]),e._storeNames.push("$meta"));var l=e._createTransaction("readwrite",e._storeNames,a);l.create(n),l._completion.catch(r);var c=l._reject.bind(l),d=ne.transless||ne;Tt(function(){return ne.trans=l,ne.transless=d,t!==0?(Kn(e,n),y=t,((g=l).storeNames.includes("$meta")?g.table("$meta").get("version").then(function(w){return w??y}):ee.resolve(y)).then(function(w){return k=w,m=l,_=n,x=[],w=(h=e)._versions,b=h._dbSchema=Rn(0,h.idbdb,_),(w=w.filter(function(S){return S._cfg.version>=k})).length!==0?(w.forEach(function(S){x.push(function(){var T=b,O=S._cfg.dbschema;Bn(h,T,_),Bn(h,O,_),b=h._dbSchema=O;var I=xr(T,O);I.add.forEach(function($){kr(_,$[0],$[1].primKey,$[1].indexes)}),I.change.forEach(function($){if($.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var X=_.objectStore($.name);$.add.forEach(function(re){return qn(X,re)}),$.change.forEach(function(re){X.deleteIndex(re.name),qn(X,re)}),$.del.forEach(function(re){return X.deleteIndex(re)})});var L=S._cfg.contentUpgrade;if(L&&S._cfg.version>k){Kn(h,_),m._memoizedTables={};var J=oe(O);I.del.forEach(function($){J[$]=T[$]}),wr(h,[h.Transaction.prototype]),Fn(h,[h.Transaction.prototype],p(J),J),m.schema=J;var U,V=Ye(L);return V&&en(),I=ee.follow(function(){var $;(U=L(m))&&V&&($=Et.bind(null,null),U.then($,$))}),U&&typeof U.then=="function"?ee.resolve(U):I.then(function(){return U})}}),x.push(function(T){var O,I,L=S._cfg.dbschema;O=L,I=T,[].slice.call(I.db.objectStoreNames).forEach(function(J){return O[J]==null&&I.db.deleteObjectStore(J)}),wr(h,[h.Transaction.prototype]),Fn(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),m.schema=h._dbSchema}),x.push(function(T){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===S._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(O){return O!=="$meta"})):T.objectStore("$meta").put(S._cfg.version,"version"))})}),function S(){return x.length?ee.resolve(x.shift()(m.idbtrans)).then(S):ee.resolve()}().then(function(){wo(b,_)})):ee.resolve();var h,k,m,_,x,b}).catch(c)):(p(a).forEach(function(w){kr(n,w,a[w].primKey,a[w].indexes)}),Kn(e,n),void ee.follow(function(){return e.on.populate.fire(l)}).catch(c));var g,y})}function Mi(e,t){wo(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Rn(0,e.idbdb,t);Bn(e,e._dbSchema,t);for(var r=0,a=xr(n,e._dbSchema).change;r<a.length;r++){var l=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var d=t.objectStore(c.name);c.add.forEach(function(g){le&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(g.src)),qn(d,g)})}(a[r]);if(typeof l=="object")return l.value}}function xr(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var a=e[n],l=t[n];if(a){var c={name:n,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||a.primKey.auto!==l.primKey.auto)c.recreate=!0,r.change.push(c);else{var d=a.idxByName,g=l.idxByName,y=void 0;for(y in d)g[y]||c.del.push(y);for(y in g){var w=d[y],h=g[y];w?w.src!==h.src&&c.change.push(h):c.add.push(h)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,l])}return r}function kr(e,t,n,r){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(l){return qn(a,l)}),a}function wo(e,t){p(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(le&&console.debug("Dexie: Creating missing table",n),kr(t,n,e[n].primKey,e[n].indexes))})}function qn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Rn(e,t,n){var r={};return j(t.objectStoreNames,0).forEach(function(a){for(var l=n.objectStore(a),c=yr(bo(y=l.keyPath),y||"",!0,!1,!!l.autoIncrement,y&&typeof y!="string",!0),d=[],g=0;g<l.indexNames.length;++g){var w=l.index(l.indexNames[g]),y=w.keyPath,w=yr(w.name,y,!!w.unique,!!w.multiEntry,!1,y&&typeof y!="string",!1);d.push(w)}r[a]=br(a,c,d)}),r}function Bn(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var l=r[a],c=n.objectStore(l);e._hasGetAll="getAll"in c;for(var d=0;d<c.indexNames.length;++d){var g=c.indexNames[d],y=c.index(g).keyPath,w=typeof y=="string"?y:"["+j(y).join("+")+"]";!t[l]||(y=t[l].idxByName[w])&&(y.name=g,delete t[l].idxByName[w],t[l].idxByName[g]=y)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&v.WorkerGlobalScope&&v instanceof v.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function xo(e){return e.split(",").map(function(t,n){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return yr(r,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),D(a),n===0)})}var Ki=(Nn.prototype._parseStoresSpec=function(e,t){p(e).forEach(function(n){if(e[n]!==null){var r=xo(e[n]),a=r.shift();if(a.unique=!0,a.multi)throw new ie.Schema("Primary key cannot be multi-valued");r.forEach(function(l){if(l.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),t[n]=br(n,a,r)}})},Nn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?E(this._cfg.storesSource,n):n;var n=t._versions,r={},a={};return n.forEach(function(l){E(r,l._cfg.storesSource),a=l._cfg.dbschema={},l._parseStoresSpec(r,a)}),t._dbSchema=a,wr(t,[t._allTables,t,t.Transaction.prototype]),Fn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],p(a),a),t._storeNames=p(a),this},Nn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ae(this._cfg.contentUpgrade||ke,e),this},Nn);function Nn(){}function Dr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Dt(Pn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Sr(e){return e&&typeof e.databases=="function"}function Tr(e){return Tt(function(){return ne.letThrough=!0,e()})}function Er(e){return!("from"in e)}var Ze=function(e,t){if(!this){var n=new Ze;return e&&"d"in e&&E(n,e),n}E(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function vn(e,t,n){var r=be(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Er(e))return E(e,{from:t,to:n,d:1});var a=e.l,r=e.r;if(be(n,e.from)<0)return a?vn(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Do(e);if(0<be(t,e.to))return r?vn(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Do(e);be(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<be(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&pn(e,a),r&&n&&pn(e,r)}}function pn(e,t){Er(t)||function n(r,g){var l=g.from,c=g.to,d=g.l,g=g.r;vn(r,l,c),d&&n(r,d),g&&n(r,g)}(e,t)}function ko(e,t){var n=Hn(t),r=n.next();if(r.done)return!1;for(var a=r.value,l=Hn(e),c=l.next(a.from),d=c.value;!r.done&&!c.done;){if(be(d.from,a.to)<=0&&0<=be(d.to,a.from))return!0;be(a.from,d.from)<0?a=(r=n.next(d.from)).value:d=(c=l.next(a.from)).value}return!1}function Hn(e){var t=Er(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&be(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||be(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Do(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<r?"r":r<-1?"l":"";a&&(t=a=="r"?"l":"r",n=u({},e),r=e[a],e.from=r.from,e.to=r.to,e[a]=r[a],n[a]=r[t],(e[t]=n).d=So(n)),e.d=So(e)}function So(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function zn(e,t){return p(t).forEach(function(n){e[n]?pn(e[n],t[n]):e[n]=function r(a){var l,c,d={};for(l in a)F(a,l)&&(c=a[l],d[l]=!c||typeof c!="object"||me.has(c.constructor)?c:r(c));return d}(t[n])}),e}function Or(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&ko(t[n],e[n])})}P(Ze.prototype,((ft={add:function(e){return pn(this,e),this},addKey:function(e){return vn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return vn(t,n,n)}),this},hasKey:function(e){var t=Hn(this).next(e).value;return t&&be(t.from,e)<=0&&0<=be(t.to,e)}})[Ue]=function(){return Hn(this)},ft));var Bt={},Cr={},Pr=!1;function Ln(e){zn(Cr,e),Pr||(Pr=!0,setTimeout(function(){Pr=!1,Ir(Cr,!(Cr={}))},0))}function Ir(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,a=Object.values(Bt);r<a.length;r++)To(c=a[r],e,n,t);else for(var l in e){var c,d=/^idb\:\/\/(.*)\/(.*)\//.exec(l);d&&(l=d[1],d=d[2],(c=Bt["idb://".concat(l,"/").concat(d)])&&To(c,e,n,t))}n.forEach(function(g){return g()})}function To(e,t,n,r){for(var a=[],l=0,c=Object.entries(e.queries.query);l<c.length;l++){for(var d=c[l],g=d[0],y=[],w=0,h=d[1];w<h.length;w++){var k=h[w];Or(t,k.obsSet)?k.subscribers.forEach(function(b){return n.add(b)}):r&&y.push(k)}r&&a.push([g,y])}if(r)for(var m=0,_=a;m<_.length;m++){var x=_[m],g=x[0],y=x[1];e.queries.query[g]=y}}function Fi(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?He(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,a=Math.round(10*e.verno),l=!1;function c(){if(t.openCanceller!==r)throw new ie.DatabaseClosed("db.open() was cancelled")}function d(){return new ee(function(k,m){if(c(),!n)throw new ie.MissingAPI;var _=e.name,x=t.autoSchema||!a?n.open(_):n.open(_,a);if(!x)throw new ie.MissingAPI;x.onerror=bt(m),x.onblocked=Me(e._fireOnBlocked),x.onupgradeneeded=Me(function(b){var S;w=x.transaction,t.autoSchema&&!e._options.allowEmptyDB?(x.onerror=cn,w.abort(),x.result.close(),(S=n.deleteDatabase(_)).onsuccess=S.onerror=Me(function(){m(new ie.NoSuchDatabase("Database ".concat(_," doesnt exist")))})):(w.onerror=bt(m),b=b.oldVersion>Math.pow(2,62)?0:b.oldVersion,h=b<1,e.idbdb=x.result,l&&Mi(e,w),Ai(e,b/10,w,m))},m),x.onsuccess=Me(function(){w=null;var b,S,T,O,I,L=e.idbdb=x.result,J=j(L.objectStoreNames);if(0<J.length)try{var U=L.transaction((O=J).length===1?O[0]:O,"readonly");if(t.autoSchema)S=L,T=U,(b=e).verno=S.version/10,T=b._dbSchema=Rn(0,S,T),b._storeNames=j(S.objectStoreNames,0),Fn(b,[b._allTables],p(T),T);else if(Bn(e,e._dbSchema,U),((I=xr(Rn(0,(I=e).idbdb,U),I._dbSchema)).add.length||I.change.some(function(V){return V.add.length||V.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),a=L.version+1,l=!0,k(d());Kn(e,U)}catch{}tn.push(e),L.onversionchange=Me(function(V){t.vcFired=!0,e.on("versionchange").fire(V)}),L.onclose=Me(function(V){e.on("close").fire(V)}),h&&(I=e._deps,U=_,L=I.indexedDB,I=I.IDBKeyRange,Sr(L)||U===Pn||Dr(L,I).put({name:U}).catch(ke)),k()},m)}).catch(function(k){switch(k==null?void 0:k.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(0<a)return a=0,d()}return ee.reject(k)})}var g,y=t.dbReadyResolve,w=null,h=!1;return ee.race([r,(typeof navigator>"u"?ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(k){function m(){return indexedDB.databases().finally(k)}g=setInterval(m,100),m()}).finally(function(){return clearInterval(g)}):Promise.resolve()).then(d)]).then(function(){return c(),t.onReadyBeingFired=[],ee.resolve(Tr(function(){return e.on.ready.fire(e.vip)})).then(function k(){if(0<t.onReadyBeingFired.length){var m=t.onReadyBeingFired.reduce(ae,ke);return t.onReadyBeingFired=[],ee.resolve(Tr(function(){return m(e.vip)})).then(k)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(k){t.dbOpenError=k;try{w&&w.abort()}catch{}return r===t.openCanceller&&e._close(),He(k)}).finally(function(){t.openComplete=!0,y()}).then(function(){var k;return h&&(k={},e.tables.forEach(function(m){m.schema.indexes.forEach(function(_){_.name&&(k["idb://".concat(e.name,"/").concat(m.name,"/").concat(_.name)]=new Ze(-1/0,[[[]]]))}),k["idb://".concat(e.name,"/").concat(m.name,"/")]=k["idb://".concat(e.name,"/").concat(m.name,"/:dels")]=new Ze(-1/0,[[[]]])}),Pt(fn).fire(k),Ir(k,!0)),e})}function jr(e){function t(l){return e.next(l)}var n=a(t),r=a(function(l){return e.throw(l)});function a(l){return function(g){var d=l(g),g=d.value;return d.done?g:g&&typeof g.then=="function"?g.then(n,r):D(g)?Promise.all(g).then(n,r):n(g)}}return a(t)()}function Un(e,t,n){for(var r=D(e)?e.slice():[e],a=0;a<n;++a)r.push(t);return r}var qi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return u(u({},e),{table:function(t){var n=e.table(t),r=n.schema,a={},l=[];function c(h,k,m){var _=hn(h),x=a[_]=a[_]||[],b=h==null?0:typeof h=="string"?1:h.length,S=0<k,S=u(u({},m),{name:S?"".concat(_,"(virtual-from:").concat(m.name,")"):m.name,lowLevelIndex:m,isVirtual:S,keyTail:k,keyLength:b,extractKey:_r(h),unique:!S&&m.unique});return x.push(S),S.isPrimaryKey||l.push(S),1<b&&c(b===2?h[0]:h.slice(0,b-1),k+1,m),x.sort(function(T,O){return T.keyTail-O.keyTail}),S}t=c(r.primaryKey.keyPath,0,r.primaryKey),a[":id"]=[t];for(var d=0,g=r.indexes;d<g.length;d++){var y=g[d];c(y.keyPath,0,y)}function w(h){var k,m=h.query.index;return m.isVirtual?u(u({},h),{query:{index:m.lowLevelIndex,range:(k=h.query.range,m=m.keyTail,{type:k.type===1?2:k.type,lower:Un(k.lower,k.lowerOpen?e.MAX_KEY:e.MIN_KEY,m),lowerOpen:!0,upper:Un(k.upper,k.upperOpen?e.MIN_KEY:e.MAX_KEY,m),upperOpen:!0})}}):h}return u(u({},n),{schema:u(u({},r),{primaryKey:t,indexes:l,getIndexByKeyPath:function(h){return(h=a[hn(h)])&&h[0]}}),count:function(h){return n.count(w(h))},query:function(h){return n.query(w(h))},openCursor:function(h){var k=h.query.index,m=k.keyTail,_=k.isVirtual,x=k.keyLength;return _?n.openCursor(w(h)).then(function(S){return S&&b(S)}):n.openCursor(h);function b(S){return Object.create(S,{continue:{value:function(T){T!=null?S.continue(Un(T,h.reverse?e.MAX_KEY:e.MIN_KEY,m)):h.unique?S.continue(S.key.slice(0,x).concat(h.reverse?e.MIN_KEY:e.MAX_KEY,m)):S.continue()}},continuePrimaryKey:{value:function(T,O){S.continuePrimaryKey(Un(T,e.MAX_KEY,m),O)}},primaryKey:{get:function(){return S.primaryKey}},key:{get:function(){var T=S.key;return x===1?T[0]:T.slice(0,x)}},value:{get:function(){return S.value}}})}}})}})}};function Ar(e,t,n,r){return n=n||{},r=r||"",p(e).forEach(function(a){var l,c,d;F(t,a)?(l=e[a],c=t[a],typeof l=="object"&&typeof c=="object"&&l&&c?(d=Re(l))!==Re(c)?n[r+a]=t[a]:d==="Object"?Ar(l,c,n,r+a+"."):l!==c&&(n[r+a]=t[a]):l!==c&&(n[r+a]=t[a])):n[r+a]=void 0}),p(t).forEach(function(a){F(e,a)||(n[r+a]=t[a])}),n}function Mr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ri={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return u(u({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return u(u({},n),{mutate:function(a){var l=ne.trans,c=l.table(t).hook,d=c.deleting,g=c.creating,y=c.updating;switch(a.type){case"add":if(g.fire===ke)break;return l._promise("readwrite",function(){return w(a)},!0);case"put":if(g.fire===ke&&y.fire===ke)break;return l._promise("readwrite",function(){return w(a)},!0);case"delete":if(d.fire===ke)break;return l._promise("readwrite",function(){return w(a)},!0);case"deleteRange":if(d.fire===ke)break;return l._promise("readwrite",function(){return function h(k,m,_){return n.query({trans:k,values:!1,query:{index:r,range:m},limit:_}).then(function(x){var b=x.result;return w({type:"delete",keys:b,trans:k}).then(function(S){return 0<S.numFailures?Promise.reject(S.failures[0]):b.length<_?{failures:[],numFailures:0,lastResult:void 0}:h(k,u(u({},m),{lower:b[b.length-1],lowerOpen:!0}),_)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function w(h){var k,m,_,x=ne.trans,b=h.keys||Mr(r,h);if(!b)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?u(u({},h),{keys:b}):u({},h)).type!=="delete"&&(h.values=f([],h.values)),h.keys&&(h.keys=f([],h.keys)),k=n,_=b,((m=h).type==="add"?Promise.resolve([]):k.getMany({trans:m.trans,keys:_,cache:"immutable"})).then(function(S){var T=b.map(function(O,I){var L,J,U,V=S[I],$={onerror:null,onsuccess:null};return h.type==="delete"?d.fire.call($,O,V,x):h.type==="add"||V===void 0?(L=g.fire.call($,O,h.values[I],x),O==null&&L!=null&&(h.keys[I]=O=L,r.outbound||N(h.values[I],r.keyPath,O))):(L=Ar(V,h.values[I]),(J=y.fire.call($,L,O,V,x))&&(U=h.values[I],Object.keys(J).forEach(function(X){F(U,X)?U[X]=J[X]:N(U,X,J[X])}))),$});return n.mutate(h).then(function(O){for(var I=O.failures,L=O.results,J=O.numFailures,O=O.lastResult,U=0;U<b.length;++U){var V=(L||b)[U],$=T[U];V==null?$.onerror&&$.onerror(I[U]):$.onsuccess&&$.onsuccess(h.type==="put"&&S[U]?h.values[U]:V)}return{failures:I,results:L,numFailures:J,lastResult:O}}).catch(function(O){return T.forEach(function(I){return I.onerror&&I.onerror(O)}),Promise.reject(O)})})}}})}})}};function Eo(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],a=0,l=0;a<t.keys.length&&l<e.length;++a)be(t.keys[a],e[l])===0&&(r.push(n?Fe(t.values[a]):t.values[a]),++l);return r.length===e.length?r:null}catch{return null}}var Bi={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return u(u({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var a=Eo(r.keys,r.trans._cache,r.cache==="clone");return a?ee.resolve(a):n.getMany(r).then(function(l){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Fe(l):l},l})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Oo(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Co(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ni={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Ze(e.MIN_KEY,e.MAX_KEY);return u(u({},e),{transaction:function(r,a,l){if(ne.subscr&&a!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ne.querier));return e.transaction(r,a,l)},table:function(r){var a=e.table(r),l=a.schema,c=l.primaryKey,h=l.indexes,d=c.extractKey,g=c.outbound,y=c.autoIncrement&&h.filter(function(m){return m.compound&&m.keyPath.includes(c.keyPath)}),w=u(u({},a),{mutate:function(m){function _(X){return X="idb://".concat(t,"/").concat(r,"/").concat(X),O[X]||(O[X]=new Ze)}var x,b,S,T=m.trans,O=m.mutatedParts||(m.mutatedParts={}),I=_(""),L=_(":dels"),J=m.type,$=m.type==="deleteRange"?[m.range]:m.type==="delete"?[m.keys]:m.values.length<50?[Mr(c,m).filter(function(X){return X}),m.values]:[],U=$[0],V=$[1],$=m.trans._cache;return D(U)?(I.addKeys(U),($=J==="delete"||U.length===V.length?Eo(U,$):null)||L.addKeys(U),($||V)&&(x=_,b=$,S=V,l.indexes.forEach(function(X){var re=x(X.name||"");function de(ge){return ge!=null?X.extractKey(ge):null}function pe(ge){return X.multiEntry&&D(ge)?ge.forEach(function(ut){return re.addKey(ut)}):re.addKey(ge)}(b||S).forEach(function(ge,$e){var fe=b&&de(b[$e]),$e=S&&de(S[$e]);be(fe,$e)!==0&&(fe!=null&&pe(fe),$e!=null&&pe($e))})}))):U?(V={from:(V=U.lower)!==null&&V!==void 0?V:e.MIN_KEY,to:(V=U.upper)!==null&&V!==void 0?V:e.MAX_KEY},L.add(V),I.add(V)):(I.add(n),L.add(n),l.indexes.forEach(function(X){return _(X.name).add(n)})),a.mutate(m).then(function(X){return!U||m.type!=="add"&&m.type!=="put"||(I.addKeys(X.results),y&&y.forEach(function(re){for(var de=m.values.map(function(fe){return re.extractKey(fe)}),pe=re.keyPath.findIndex(function(fe){return fe===c.keyPath}),ge=0,ut=X.results.length;ge<ut;++ge)de[ge][pe]=X.results[ge];_(re.name).addKeys(de)})),T.mutatedParts=zn(T.mutatedParts||{},O),X})}}),h=function(_){var x=_.query,_=x.index,x=x.range;return[_,new Ze((_=x.lower)!==null&&_!==void 0?_:e.MIN_KEY,(x=x.upper)!==null&&x!==void 0?x:e.MAX_KEY)]},k={get:function(m){return[c,new Ze(m.key)]},getMany:function(m){return[c,new Ze().addKeys(m.keys)]},count:h,query:h,openCursor:h};return p(k).forEach(function(m){w[m]=function(_){var x=ne.subscr,b=!!x,S=Oo(ne,a)&&Co(m,_)?_.obsSet={}:x;if(b){var T=function(V){return V="idb://".concat(t,"/").concat(r,"/").concat(V),S[V]||(S[V]=new Ze)},O=T(""),I=T(":dels"),x=k[m](_),b=x[0],x=x[1];if((m==="query"&&b.isPrimaryKey&&!_.values?I:T(b.name||"")).add(x),!b.isPrimaryKey){if(m!=="count"){var L=m==="query"&&g&&_.values&&a.query(u(u({},_),{values:!1}));return a[m].apply(this,arguments).then(function(V){if(m==="query"){if(g&&_.values)return L.then(function(de){return de=de.result,O.addKeys(de),V});var $=_.values?V.result.map(d):V.result;(_.values?O:I).addKeys($)}else if(m==="openCursor"){var X=V,re=_.values;return X&&Object.create(X,{key:{get:function(){return I.addKey(X.primaryKey),X.key}},primaryKey:{get:function(){var de=X.primaryKey;return I.addKey(de),de}},value:{get:function(){return re&&O.addKey(X.primaryKey),X.value}}})}return V})}I.add(n)}}return a[m].apply(this,arguments)}}),w}})}};function Po(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=u({},t),D(t.keys)&&(t.keys=t.keys.filter(function(a,l){return!(l in n.failures)})),"values"in t&&D(t.values)&&(t.values=t.values.filter(function(a,l){return!(l in n.failures)})),t)}function Kr(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<be(n,r.lower):0<=be(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?be(e,t.upper)<0:be(e,t.upper)<=0));var n,r}function Io(e,t,k,r,a,l){if(!k||k.length===0)return e;var c=t.query.index,d=c.multiEntry,g=t.query.range,y=r.schema.primaryKey.extractKey,w=c.extractKey,h=(c.lowLevelIndex||c).extractKey,k=k.reduce(function(m,_){var x=m,b=[];if(_.type==="add"||_.type==="put")for(var S=new Ze,T=_.values.length-1;0<=T;--T){var O,I=_.values[T],L=y(I);S.hasKey(L)||(O=w(I),(d&&D(O)?O.some(function(X){return Kr(X,g)}):Kr(O,g))&&(S.addKey(L),b.push(I)))}switch(_.type){case"add":var J=new Ze().addKeys(t.values?m.map(function(re){return y(re)}):m),x=m.concat(t.values?b.filter(function(re){return re=y(re),!J.hasKey(re)&&(J.addKey(re),!0)}):b.map(function(re){return y(re)}).filter(function(re){return!J.hasKey(re)&&(J.addKey(re),!0)}));break;case"put":var U=new Ze().addKeys(_.values.map(function(re){return y(re)}));x=m.filter(function(re){return!U.hasKey(t.values?y(re):re)}).concat(t.values?b:b.map(function(re){return y(re)}));break;case"delete":var V=new Ze().addKeys(_.keys);x=m.filter(function(re){return!V.hasKey(t.values?y(re):re)});break;case"deleteRange":var $=_.range;x=m.filter(function(re){return!Kr(y(re),$)})}return x},e);return k===e?e:(k.sort(function(m,_){return be(h(m),h(_))||be(y(m),y(_))}),t.limit&&t.limit<1/0&&(k.length>t.limit?k.length=t.limit:e.length===t.limit&&k.length<t.limit&&(a.dirty=!0)),l?Object.freeze(k):k)}function jo(e,t){return be(e.lower,t.lower)===0&&be(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Hi(e,t){return function(n,r,a,l){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=be(n,r))===0){if(a&&l)return 0;if(a)return 1;if(l)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,a,l){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=be(n,r))===0){if(a&&l)return 0;if(a)return-1;if(l)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function zi(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var a,l;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,l=t,setTimeout(function(){a.subscribers.size===0&&ce(l,a)},3e3))})}var Li={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return u(u({},e),{transaction:function(n,r,a){var l,c,d=e.transaction(n,r,a);return r==="readwrite"&&(c=(l=new AbortController).signal,a=function(g){return function(){if(l.abort(),r==="readwrite"){for(var y=new Set,w=0,h=n;w<h.length;w++){var k=h[w],m=Bt["idb://".concat(t,"/").concat(k)];if(m){var _=e.table(k),x=m.optimisticOps.filter(function(re){return re.trans===d});if(d._explicit&&g&&d.mutatedParts)for(var b=0,S=Object.values(m.queries.query);b<S.length;b++)for(var T=0,O=(J=S[b]).slice();T<O.length;T++)Or((U=O[T]).obsSet,d.mutatedParts)&&(ce(J,U),U.subscribers.forEach(function(re){return y.add(re)}));else if(0<x.length){m.optimisticOps=m.optimisticOps.filter(function(re){return re.trans!==d});for(var I=0,L=Object.values(m.queries.query);I<L.length;I++)for(var J,U,V,$=0,X=(J=L[I]).slice();$<X.length;$++)(U=X[$]).res!=null&&d.mutatedParts&&(g&&!U.dirty?(V=Object.isFrozen(U.res),V=Io(U.res,U.req,x,_,U,V),U.dirty?(ce(J,U),U.subscribers.forEach(function(re){return y.add(re)})):V!==U.res&&(U.res=V,U.promise=ee.resolve({result:V}))):(U.dirty&&ce(J,U),U.subscribers.forEach(function(re){return y.add(re)})))}}}y.forEach(function(re){return re()})}}},d.addEventListener("abort",a(!1),{signal:c}),d.addEventListener("error",a(!1),{signal:c}),d.addEventListener("complete",a(!0),{signal:c})),d},table:function(n){var r=e.table(n),a=r.schema.primaryKey;return u(u({},r),{mutate:function(l){var c=ne.trans;if(a.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return r.mutate(l);var d=Bt["idb://".concat(t,"/").concat(n)];return d?(c=r.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||Mr(a,l).some(function(g){return g==null}))?(d.optimisticOps.push(l),l.mutatedParts&&Ln(l.mutatedParts),c.then(function(g){0<g.numFailures&&(ce(d.optimisticOps,l),(g=Po(0,l,g))&&d.optimisticOps.push(g),l.mutatedParts&&Ln(l.mutatedParts))}),c.catch(function(){ce(d.optimisticOps,l),l.mutatedParts&&Ln(l.mutatedParts)})):c.then(function(g){var y=Po(0,u(u({},l),{values:l.values.map(function(w,h){var k;return g.failures[h]?w:(w=(k=a.keyPath)!==null&&k!==void 0&&k.includes(".")?Fe(w):u({},w),N(w,a.keyPath,g.results[h]),w)})}),g);d.optimisticOps.push(y),queueMicrotask(function(){return l.mutatedParts&&Ln(l.mutatedParts)})}),c):r.mutate(l)},query:function(l){if(!Oo(ne,r)||!Co("query",l))return r.query(l);var c=((y=ne.trans)===null||y===void 0?void 0:y.db._options.cache)==="immutable",h=ne,d=h.requery,g=h.signal,y=function(_,x,b,S){var T=Bt["idb://".concat(_,"/").concat(x)];if(!T)return[];if(!(x=T.queries[b]))return[null,!1,T,null];var O=x[(S.query?S.query.index.name:null)||""];if(!O)return[null,!1,T,null];switch(b){case"query":var I=O.find(function(L){return L.req.limit===S.limit&&L.req.values===S.values&&jo(L.req.query.range,S.query.range)});return I?[I,!0,T,O]:[O.find(function(L){return("limit"in L.req?L.req.limit:1/0)>=S.limit&&(!S.values||L.req.values)&&Hi(L.req.query.range,S.query.range)}),!1,T,O];case"count":return I=O.find(function(L){return jo(L.req.query.range,S.query.range)}),[I,!!I,T,O]}}(t,n,"query",l),w=y[0],h=y[1],k=y[2],m=y[3];return w&&h?w.obsSet=l.obsSet:(h=r.query(l).then(function(_){var x=_.result;if(w&&(w.res=x),c){for(var b=0,S=x.length;b<S;++b)Object.freeze(x[b]);Object.freeze(x)}else _.result=Fe(x);return _}).catch(function(_){return m&&w&&ce(m,w),Promise.reject(_)}),w={obsSet:l.obsSet,promise:h,subscribers:new Set,type:"query",req:l,dirty:!1},m?m.push(w):(m=[w],(k=k||(Bt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=m)),zi(w,m,d,g),w.promise.then(function(_){return{result:Io(_.result,l,k==null?void 0:k.optimisticOps,r,w,c)}})}})}})}};function Yn(e,t){return new Proxy(e,{get:function(n,r,a){return r==="db"?t:Reflect.get(n,r,a)}})}var Dt=(ze.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ie.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(ji),n.stores({}),this._state.autoSchema=!1,n)},ze.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ne.letThrough||this._vip)?e():new ee(function(n,r){if(t._state.openComplete)return r(new ie.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new ie.DatabaseClosed);t.open().catch(ke)}t._state.dbReadyPromise.then(n,r)}).then(e)},ze.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:a}),e.sort(function(l,c){return l.level-c.level}),this},ze.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return r?a.create!==r:!!n&&a.name!==n})),this},ze.prototype.open=function(){var e=this;return Ft(pt,function(){return Fi(e)})},ze.prototype._close=function(){var e=this._state,t=tn.indexOf(this);if(0<=t&&tn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new ee(function(n){e.dbReadyResolve=n}),e.openCanceller=new ee(function(n,r){e.cancelOpen=r}))},ze.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new ie.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new ie.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ze.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new ee(function(a,l){function c(){t.close(e);var d=t._deps.indexedDB.deleteDatabase(t.name);d.onsuccess=Me(function(){var g,y,w;g=t._deps,y=t.name,w=g.indexedDB,g=g.IDBKeyRange,Sr(w)||y===Pn||Dr(w,g).delete(y).catch(ke),a()}),d.onerror=bt(l),d.onblocked=t._fireOnBlocked}if(n)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},ze.prototype.backendDB=function(){return this.idbdb},ze.prototype.isOpen=function(){return this.idbdb!==null},ze.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ze.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ze.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ze.prototype,"tables",{get:function(){var e=this;return p(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ze.prototype.transaction=function(){var e=(function(t,n,r){var a=arguments.length;if(a<2)throw new ie.InvalidArgument("Too few arguments");for(var l=new Array(a-1);--a;)l[a-1]=arguments[a];return r=l.pop(),[t,se(l),r]}).apply(this,arguments);return this._transaction.apply(this,e)},ze.prototype._transaction=function(e,t,n){var r=this,a=ne.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var l,c,d=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(y){if(y=y instanceof r.Table?y.name:y,typeof y!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return y}),e=="r"||e===dr)l=dr;else{if(e!="rw"&&e!=hr)throw new ie.InvalidArgument("Invalid transaction mode: "+e);l=hr}if(a){if(a.mode===dr&&l===hr){if(!d)throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&c.forEach(function(y){if(a&&a.storeNames.indexOf(y)===-1){if(!d)throw new ie.SubTransaction("Table "+y+" not included in parent transaction.");a=null}}),d&&a&&!a.active&&(a=null)}}catch(y){return a?a._promise(null,function(w,h){h(y)}):He(y)}var g=(function y(w,h,k,m,_){return ee.resolve().then(function(){var x=ne.transless||ne,b=w._createTransaction(h,k,w._dbSchema,m);if(b.explicit=!0,x={trans:b,transless:x},m)b.idbtrans=m.idbtrans;else try{b.create(),b.idbtrans._explicit=!0,w._state.PR1398_maxLoop=3}catch(O){return O.name===ct.InvalidState&&w.isOpen()&&0<--w._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),w.close({disableAutoOpen:!1}),w.open().then(function(){return y(w,h,k,null,_)})):He(O)}var S,T=Ye(_);return T&&en(),x=ee.follow(function(){var O;(S=_.call(b,b))&&(T?(O=Et.bind(null,null),S.then(O,O)):typeof S.next=="function"&&typeof S.throw=="function"&&(S=jr(S)))},x),(S&&typeof S.then=="function"?ee.resolve(S).then(function(O){return b.active?O:He(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):x.then(function(){return S})).then(function(O){return m&&b._resolve(),b._completion.then(function(){return O})}).catch(function(O){return b._reject(O),He(O)})})}).bind(null,this,l,c,a,n);return a?a._promise(l,g,"lock"):ne.trans?Ft(ne.transless,function(){return r._whenReady(g)}):this._whenReady(g)},ze.prototype.table=function(e){if(!F(this._allTables,e))throw new ie.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ze);function ze(e,t){var n=this;this._middlewares={},this.verno=0;var r=ze.dependencies;this._options=t=u({addons:ze.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,l,c,d,g,y={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};y.dbReadyPromise=new ee(function(h){y.dbReadyResolve=h}),y.openCanceller=new ee(function(h,k){y.cancelOpen=k}),this._state=y,this.name=e,this.on=sn(this,"populate","blocked","versionchange","close",{ready:[ae,ke]}),this.on.ready.subscribe=z(this.on.ready.subscribe,function(h){return function(k,m){ze.vip(function(){var _,x=n._state;x.openComplete?(x.dbOpenError||ee.resolve().then(k),m&&h(k)):x.onReadyBeingFired?(x.onReadyBeingFired.push(k),m&&h(k)):(h(k),_=n,m||h(function b(){_.on.ready.unsubscribe(k),_.on.ready.unsubscribe(b)}))})}}),this.Collection=(a=this,un(Si.prototype,function(S,b){this.db=a;var m=uo,_=null;if(b)try{m=b()}catch(T){_=T}var x=S._ctx,b=x.table,S=b.hook.reading.fire;this._ctx={table:b,index:x.index,isPrimKey:!x.index||b.schema.primKey.keyPath&&x.index===b.schema.primKey.name,range:m,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:_,or:x.or,valueMapper:S!==Mt?S:null}})),this.Table=(l=this,un(ho.prototype,function(h,k,m){this.db=l,this._tx=m,this.name=h,this.schema=k,this.hook=l._allTables[h]?l._allTables[h].hook:sn(null,{creating:[xn,ke],reading:[wn,Mt],updating:[Dn,ke],deleting:[kn,ke]})})),this.Transaction=(c=this,un(Oi.prototype,function(h,k,m,_,x){var b=this;this.db=c,this.mode=h,this.storeNames=k,this.schema=m,this.chromeTransactionDurability=_,this.idbtrans=null,this.on=sn(this,"complete","error","abort"),this.parent=x||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ee(function(S,T){b._resolve=S,b._reject=T}),this._completion.then(function(){b.active=!1,b.on.complete.fire()},function(S){var T=b.active;return b.active=!1,b.on.error.fire(S),b.parent?b.parent._reject(S):T&&b.idbtrans&&b.idbtrans.abort(),He(S)})})),this.Version=(d=this,un(Ki.prototype,function(h){this.db=d,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,un(yo.prototype,function(h,k,m){if(this.db=g,this._ctx={table:h,index:k===":id"?null:k,or:m},this._cmp=this._ascending=be,this._descending=function(_,x){return be(x,_)},this._max=function(_,x){return 0<be(_,x)?_:x},this._min=function(_,x){return be(_,x)<0?_:x},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=dn(t.IDBKeyRange),this._createTransaction=function(h,k,m,_){return new n.Transaction(h,k,m,n._options.chromeTransactionDurability,_)},this._fireOnBlocked=function(h){n.on("blocked").fire(h),tn.filter(function(k){return k.name===n.name&&k!==n&&!k._state.vcFired}).map(function(k){return k.on("versionchange").fire(h)})},this.use(Bi),this.use(Li),this.use(Ni),this.use(qi),this.use(Ri);var w=new Proxy(this,{get:function(h,k,m){if(k==="_vip")return!0;if(k==="table")return function(x){return Yn(n.table(x),w)};var _=Reflect.get(h,k,m);return _ instanceof ho?Yn(_,w):k==="tables"?_.map(function(x){return Yn(x,w)}):k==="_createTransaction"?function(){return Yn(_.apply(this,arguments),w)}:_}});this.vip=w,r.forEach(function(h){return h(n)})}var Wn,ft=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ui=(Fr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},Fr.prototype[ft]=function(){return this},Fr);function Fr(e){this._subscribe=e}try{Wn={indexedDB:v.indexedDB||v.mozIndexedDB||v.webkitIndexedDB||v.msIndexedDB,IDBKeyRange:v.IDBKeyRange||v.webkitIDBKeyRange}}catch{Wn={indexedDB:null,IDBKeyRange:null}}function Ao(e){var t,n=!1,r=new Ui(function(a){var l=Ye(e),c,d=!1,g={},y={},w={get closed(){return d},unsubscribe:function(){d||(d=!0,c&&c.abort(),h&&Pt.storagemutated.unsubscribe(m))}};a.start&&a.start(w);var h=!1,k=function(){return fr(_)},m=function(x){zn(g,x),Or(y,g)&&k()},_=function(){var x,b,S;!d&&Wn.indexedDB&&(g={},x={},c&&c.abort(),c=new AbortController,S=function(T){var O=Zt();try{l&&en();var I=Tt(e,T);return I=l?I.finally(Et):I}finally{O&&$t()}}(b={subscr:x,signal:c.signal,requery:k,querier:e,trans:null}),Promise.resolve(S).then(function(T){n=!0,t=T,d||b.signal.aborted||(g={},function(O){for(var I in O)if(F(O,I))return;return 1}(y=x)||h||(Pt(fn,m),h=!0),fr(function(){return!d&&a.next&&a.next(T)}))},function(T){n=!1,["DatabaseClosedError","AbortError"].includes(T==null?void 0:T.name)||d||fr(function(){d||a.error&&a.error(T)})}))};return setTimeout(k,0),w});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var Nt=Dt;function qr(e){var t=It;try{It=!0,Pt.storagemutated.fire(e),Ir(e,!0)}finally{It=t}}P(Nt,u(u({},mt),{delete:function(e){return new Nt(e,{addons:[]}).delete()},exists:function(e){return new Nt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Nt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Sr(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(a){return a.name}).filter(function(a){return a!==Pn})}):Dr(n,t).toCollection().primaryKeys()).then(e)}catch{return He(new ie.MissingAPI)}var t,n},defineClass:function(){return function(e){E(this,e)}},ignoreTransaction:function(e){return ne.trans?Ft(ne.transless,e):e()},vip:Tr,async:function(e){return function(){try{var t=jr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:ee.resolve(t)}catch(n){return He(n)}}},spawn:function(e,t,n){try{var r=jr(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:ee.resolve(r)}catch(a){return He(a)}},currentTransaction:{get:function(){return ne.trans||null}},waitFor:function(e,t){return t=ee.resolve(typeof e=="function"?Nt.ignoreTransaction(e):e).timeout(t||6e4),ne.trans?ne.trans.waitFor(t):t},Promise:ee,debug:{get:function(){return le},set:function(e){_e(e)}},derive:Q,extend:E,props:P,override:z,Events:sn,on:Pt,liveQuery:Ao,extendObservabilitySet:zn,getByKeyPath:W,setByKeyPath:N,delByKeyPath:function(e,t){typeof t=="string"?N(e,t,void 0):"length"in t&&[].map.call(t,function(n){N(e,n,void 0)})},shallowClone:oe,deepClone:Fe,getObjectDiff:Ar,cmp:be,asap:B,minKey:-1/0,addons:[],connections:tn,errnames:ct,dependencies:Wn,cache:Bt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Nt.maxKey=dn(Nt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Pt(fn,function(e){It||(e=new CustomEvent(mr,{detail:e}),It=!0,dispatchEvent(e),It=!1)}),addEventListener(mr,function(e){e=e.detail,It||qr(e)}));var on,It=!1,Mo=function(){};return typeof BroadcastChannel<"u"&&((Mo=function(){(on=new BroadcastChannel(mr)).onmessage=function(e){return e.data&&qr(e.data)}})(),typeof on.unref=="function"&&on.unref(),Pt(fn,function(e){It||on.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Dt.disableBfCache&&e.persisted){le&&console.debug("Dexie: handling persisted pagehide"),on!=null&&on.close();for(var t=0,n=tn;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Dt.disableBfCache&&e.persisted&&(le&&console.debug("Dexie: handling persisted pageshow"),Mo(),qr({all:new Ze(-1/0,[[]])}))})),ee.rejectionMapper=function(e,t){return!e||e instanceof We||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Vt[e.name]?e:(t=new Vt[e.name](t||e.message,e),"stack"in e&&H(t,"stack",{get:function(){return this.inner.stack}}),t)},_e(le),u(Dt,Object.freeze({__proto__:null,Dexie:Dt,liveQuery:Ao,Entity:lo,cmp:be,PropModification:ln,replacePrefix:function(e,t){return new ln({replacePrefix:[e,t]})},add:function(e){return new ln({add:e})},remove:function(e){return new ln({remove:e})},default:Dt,RangeSet:Ze,mergeRanges:pn,rangesOverlap:ko}),{default:Dt}),Dt})}($n)),$n.exports}var Oa=Ea();const Wr=Sa(Oa),Lo=Symbol.for("Dexie"),nr=globalThis[Lo]||(globalThis[Lo]=Wr);if(Wr.semVer!==nr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Wr.semVer} and ${nr.semVer}`);const{liveQuery:rl,mergeRanges:ol,rangesOverlap:il,RangeSet:al,cmp:sl,Entity:ul,PropModification:ll,replacePrefix:cl,add:fl,remove:dl}=nr;class Ca{constructor(){this._db=new nr("FastingHours"),this._db.version(20).stores({history:"id, started",hunger:"id, created",water:"id, created"})}browseHistory(){return this._db.history.toArray()}browseHistoryByEnd(){return this._db.history.toArray().then(o=>o.filter(u=>u.ended===null)[0])}readHistory(o){return this._db.history.get({id:o})}editHistory(o){const i=Hr(o);return i.updated=new Date,this._db.history.put(i).then(()=>this._db.history.get({id:o.id}))}addHistory(){const o={id:crypto.randomUUID(),type:"history",created:new Date,updated:new Date,started:new Date,ended:null,notes:null};return this._db.history.add(o).then(()=>this._db.history.get({id:o.id}))}deleteHistory(o){return this._db.history.delete(o)}browseHunger(o=!1){return this._db.hunger.toArray().then(i=>o?(i.sort((u,f)=>u.created.getTime()<f.created.getTime()?1:u.created.getTime()>f.created.getTime()?-1:0),i.length===0?null:i[0]):i)}readHunger(o){return this._db.hunger.get({id:o})}editHunger(o){const i=Hr(o);return i.updated=new Date,this._db.hunger.put(i).then(()=>this._db.hunger.get({id:o.id}))}addHunger(o=5){const i={id:crypto.randomUUID(),type:"hunger",created:new Date,updated:new Date,level:o};return this._db.hunger.add(i).then(()=>this._db.hunger.get({id:i.id}))}deleteHunger(o){return this._db.hunger.delete(o)}browseWater(o=!1){return this._db.water.toArray().then(i=>{if(o){const u=new Date;u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0);const f=new Date(u.getTime());return f.setDate(f.getDate()+1),i.filter(v=>v.created.getTime()>u.getTime()&&v.created.getTime()<f.getTime())}else return i})}readWater(o){return this._db.water.get({id:o})}editWater(o){const i=Hr(o);return i.updated=new Date,this._db.water.put(i).then(()=>this._db.water.get({id:o.id}))}addWater(o){const i={id:crypto.randomUUID(),type:"water",created:new Date,updated:new Date,volume:o};return crypto.randomUUID(),this._db.water.add(i).then(()=>this._db.water.get({id:i.id}))}deleteWater(o){return this._db.water.delete(o)}}const ui=/^[a-z0-9]+(-[a-z0-9]+)*$/,or=(s,o,i,u="")=>{const f=s.split(":");if(s.slice(0,1)==="@"){if(f.length<2||f.length>3)return null;u=f.shift().slice(1)}if(f.length>3||!f.length)return null;if(f.length>1){const D=f.pop(),E=f.pop(),M={provider:f.length>0?f[0]:u,prefix:E,name:D};return o&&!er(M)?null:M}const v=f[0],p=v.split("-");if(p.length>1){const D={provider:u,prefix:p.shift(),name:p.join("-")};return o&&!er(D)?null:D}if(i&&u===""){const D={provider:u,prefix:"",name:v};return o&&!er(D,i)?null:D}return null},er=(s,o)=>s?!!((o&&s.prefix===""||s.prefix)&&s.name):!1,li=Object.freeze({left:0,top:0,width:16,height:16}),rr=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),ir=Object.freeze({...li,...rr}),Vr=Object.freeze({...ir,body:"",hidden:!1});function Pa(s,o){const i={};!s.hFlip!=!o.hFlip&&(i.hFlip=!0),!s.vFlip!=!o.vFlip&&(i.vFlip=!0);const u=((s.rotate||0)+(o.rotate||0))%4;return u&&(i.rotate=u),i}function Uo(s,o){const i=Pa(s,o);for(const u in Vr)u in rr?u in s&&!(u in i)&&(i[u]=rr[u]):u in o?i[u]=o[u]:u in s&&(i[u]=s[u]);return i}function Ia(s,o){const i=s.icons,u=s.aliases||Object.create(null),f=Object.create(null);function v(p){if(i[p])return f[p]=[];if(!(p in f)){f[p]=null;const D=u[p]&&u[p].parent,E=D&&v(D);E&&(f[p]=[D].concat(E))}return f[p]}return Object.keys(i).concat(Object.keys(u)).forEach(v),f}function ja(s,o,i){const u=s.icons,f=s.aliases||Object.create(null);let v={};function p(D){v=Uo(u[D]||f[D],v)}return p(o),i.forEach(p),Uo(s,v)}function ci(s,o){const i=[];if(typeof s!="object"||typeof s.icons!="object")return i;s.not_found instanceof Array&&s.not_found.forEach(f=>{o(f,null),i.push(f)});const u=Ia(s);for(const f in u){const v=u[f];v&&(o(f,ja(s,f,v)),i.push(f))}return i}const Aa={provider:"",aliases:{},not_found:{},...li};function zr(s,o){for(const i in o)if(i in s&&typeof s[i]!=typeof o[i])return!1;return!0}function fi(s){if(typeof s!="object"||s===null)return null;const o=s;if(typeof o.prefix!="string"||!s.icons||typeof s.icons!="object"||!zr(s,Aa))return null;const i=o.icons;for(const f in i){const v=i[f];if(!f||typeof v.body!="string"||!zr(v,Vr))return null}const u=o.aliases||Object.create(null);for(const f in u){const v=u[f],p=v.parent;if(!f||typeof p!="string"||!i[p]&&!u[p]||!zr(v,Vr))return null}return o}const Yo=Object.create(null);function Ma(s,o){return{provider:s,prefix:o,icons:Object.create(null),missing:new Set}}function an(s,o){const i=Yo[s]||(Yo[s]=Object.create(null));return i[o]||(i[o]=Ma(s,o))}function di(s,o){return fi(o)?ci(o,(i,u)=>{u?s.icons[i]=u:s.missing.add(i)}):[]}function Ka(s,o,i){try{if(typeof i.body=="string")return s.icons[o]={...i},!0}catch{}return!1}let _n=!1;function hi(s){return typeof s=="boolean"&&(_n=s),_n}function Fa(s){const o=typeof s=="string"?or(s,!0,_n):s;if(o){const i=an(o.provider,o.prefix),u=o.name;return i.icons[u]||(i.missing.has(u)?null:void 0)}}function qa(s,o){const i=or(s,!0,_n);if(!i)return!1;const u=an(i.provider,i.prefix);return o?Ka(u,i.name,o):(u.missing.add(i.name),!0)}function Ra(s,o){if(typeof s!="object")return!1;if(typeof o!="string"&&(o=s.provider||""),_n&&!o&&!s.prefix){let f=!1;return fi(s)&&(s.prefix="",ci(s,(v,p)=>{qa(v,p)&&(f=!0)})),f}const i=s.prefix;if(!er({prefix:i,name:"a"}))return!1;const u=an(o,i);return!!di(u,s)}const vi=Object.freeze({width:null,height:null}),pi=Object.freeze({...vi,...rr}),Ba=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Na=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Wo(s,o,i){if(o===1)return s;if(i=i||100,typeof s=="number")return Math.ceil(s*o*i)/i;if(typeof s!="string")return s;const u=s.split(Ba);if(u===null||!u.length)return s;const f=[];let v=u.shift(),p=Na.test(v);for(;;){if(p){const D=parseFloat(v);isNaN(D)?f.push(v):f.push(Math.ceil(D*o*i)/i)}else f.push(v);if(v=u.shift(),v===void 0)return f.join("");p=!p}}function Ha(s,o="defs"){let i="";const u=s.indexOf("<"+o);for(;u>=0;){const f=s.indexOf(">",u),v=s.indexOf("</"+o);if(f===-1||v===-1)break;const p=s.indexOf(">",v);if(p===-1)break;i+=s.slice(f+1,v).trim(),s=s.slice(0,u).trim()+s.slice(p+1)}return{defs:i,content:s}}function za(s,o){return s?"<defs>"+s+"</defs>"+o:o}function La(s,o,i){const u=Ha(s);return za(u.defs,o+u.content+i)}const Ua=s=>s==="unset"||s==="undefined"||s==="none";function Ya(s,o){const i={...ir,...s},u={...pi,...o},f={left:i.left,top:i.top,width:i.width,height:i.height};let v=i.body;[i,u].forEach(Q=>{const Z=[],G=Q.hFlip,j=Q.vFlip;let z=Q.rotate;G?j?z+=2:(Z.push("translate("+(f.width+f.left).toString()+" "+(0-f.top).toString()+")"),Z.push("scale(-1 1)"),f.top=f.left=0):j&&(Z.push("translate("+(0-f.left).toString()+" "+(f.height+f.top).toString()+")"),Z.push("scale(1 -1)"),f.top=f.left=0);let q;switch(z<0&&(z-=Math.floor(z/4)*4),z=z%4,z){case 1:q=f.height/2+f.top,Z.unshift("rotate(90 "+q.toString()+" "+q.toString()+")");break;case 2:Z.unshift("rotate(180 "+(f.width/2+f.left).toString()+" "+(f.height/2+f.top).toString()+")");break;case 3:q=f.width/2+f.left,Z.unshift("rotate(-90 "+q.toString()+" "+q.toString()+")");break}z%2===1&&(f.left!==f.top&&(q=f.left,f.left=f.top,f.top=q),f.width!==f.height&&(q=f.width,f.width=f.height,f.height=q)),Z.length&&(v=La(v,'<g transform="'+Z.join(" ")+'">',"</g>"))});const p=u.width,D=u.height,E=f.width,M=f.height;let A,F;p===null?(F=D===null?"1em":D==="auto"?M:D,A=Wo(F,E/M)):(A=p==="auto"?E:p,F=D===null?Wo(A,M/E):D==="auto"?M:D);const P={},Y=(Q,Z)=>{Ua(Z)||(P[Q]=Z.toString())};Y("width",A),Y("height",F);const H=[f.left,f.top,E,M];return P.viewBox=H.join(" "),{attributes:P,viewBox:H,body:v}}const Wa=/\sid="(\S+)"/g,Va="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Qa=0;function Ga(s,o=Va){const i=[];let u;for(;u=Wa.exec(s);)i.push(u[1]);if(!i.length)return s;const f="suffix"+(Math.random()*16777216|Date.now()).toString(16);return i.forEach(v=>{const p=typeof o=="function"?o(v):o+(Qa++).toString(),D=v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");s=s.replace(new RegExp('([#;"])('+D+')([")]|\\.[a-z])',"g"),"$1"+p+f+"$3")}),s=s.replace(new RegExp(f,"g"),""),s}const Qr=Object.create(null);function Xa(s,o){Qr[s]=o}function Gr(s){return Qr[s]||Qr[""]}function eo(s){let o;if(typeof s.resources=="string")o=[s.resources];else if(o=s.resources,!(o instanceof Array)||!o.length)return null;return{resources:o,path:s.path||"/",maxURL:s.maxURL||500,rotate:s.rotate||750,timeout:s.timeout||5e3,random:s.random===!0,index:s.index||0,dataAfterTimeout:s.dataAfterTimeout!==!1}}const to=Object.create(null),gn=["https://api.simplesvg.com","https://api.unisvg.com"],tr=[];for(;gn.length>0;)gn.length===1||Math.random()>.5?tr.push(gn.shift()):tr.push(gn.pop());to[""]=eo({resources:["https://api.iconify.design"].concat(tr)});function Ja(s,o){const i=eo(o);return i===null?!1:(to[s]=i,!0)}function no(s){return to[s]}const Za=()=>{let s;try{if(s=fetch,typeof s=="function")return s}catch{}};let Vo=Za();function $a(s,o){const i=no(s);if(!i)return 0;let u;if(!i.maxURL)u=0;else{let f=0;i.resources.forEach(p=>{f=Math.max(f,p.length)});const v=o+".json?icons=";u=i.maxURL-f-i.path.length-v.length}return u}function es(s){return s===404}const ts=(s,o,i)=>{const u=[],f=$a(s,o),v="icons";let p={type:v,provider:s,prefix:o,icons:[]},D=0;return i.forEach((E,M)=>{D+=E.length+1,D>=f&&M>0&&(u.push(p),p={type:v,provider:s,prefix:o,icons:[]},D=E.length),p.icons.push(E)}),u.push(p),u};function ns(s){if(typeof s=="string"){const o=no(s);if(o)return o.path}return"/"}const rs=(s,o,i)=>{if(!Vo){i("abort",424);return}let u=ns(o.provider);switch(o.type){case"icons":{const v=o.prefix,D=o.icons.join(","),E=new URLSearchParams({icons:D});u+=v+".json?"+E.toString();break}case"custom":{const v=o.uri;u+=v.slice(0,1)==="/"?v.slice(1):v;break}default:i("abort",400);return}let f=503;Vo(s+u).then(v=>{const p=v.status;if(p!==200){setTimeout(()=>{i(es(p)?"abort":"next",p)});return}return f=501,v.json()}).then(v=>{if(typeof v!="object"||v===null){setTimeout(()=>{v===404?i("abort",v):i("next",f)});return}setTimeout(()=>{i("success",v)})}).catch(()=>{i("next",f)})},os={prepare:ts,send:rs};function is(s){const o={loaded:[],missing:[],pending:[]},i=Object.create(null);s.sort((f,v)=>f.provider!==v.provider?f.provider.localeCompare(v.provider):f.prefix!==v.prefix?f.prefix.localeCompare(v.prefix):f.name.localeCompare(v.name));let u={provider:"",prefix:"",name:""};return s.forEach(f=>{if(u.name===f.name&&u.prefix===f.prefix&&u.provider===f.provider)return;u=f;const v=f.provider,p=f.prefix,D=f.name,E=i[v]||(i[v]=Object.create(null)),M=E[p]||(E[p]=an(v,p));let A;D in M.icons?A=o.loaded:p===""||M.missing.has(D)?A=o.missing:A=o.pending;const F={provider:v,prefix:p,name:D};A.push(F)}),o}function gi(s,o){s.forEach(i=>{const u=i.loaderCallbacks;u&&(i.loaderCallbacks=u.filter(f=>f.id!==o))})}function as(s){s.pendingCallbacksFlag||(s.pendingCallbacksFlag=!0,setTimeout(()=>{s.pendingCallbacksFlag=!1;const o=s.loaderCallbacks?s.loaderCallbacks.slice(0):[];if(!o.length)return;let i=!1;const u=s.provider,f=s.prefix;o.forEach(v=>{const p=v.icons,D=p.pending.length;p.pending=p.pending.filter(E=>{if(E.prefix!==f)return!0;const M=E.name;if(s.icons[M])p.loaded.push({provider:u,prefix:f,name:M});else if(s.missing.has(M))p.missing.push({provider:u,prefix:f,name:M});else return i=!0,!0;return!1}),p.pending.length!==D&&(i||gi([s],v.id),v.callback(p.loaded.slice(0),p.missing.slice(0),p.pending.slice(0),v.abort))})}))}let ss=0;function us(s,o,i){const u=ss++,f=gi.bind(null,i,u);if(!o.pending.length)return f;const v={id:u,icons:o,callback:s,abort:f};return i.forEach(p=>{(p.loaderCallbacks||(p.loaderCallbacks=[])).push(v)}),f}function ls(s,o=!0,i=!1){const u=[];return s.forEach(f=>{const v=typeof f=="string"?or(f,o,i):f;v&&u.push(v)}),u}var cs={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function fs(s,o,i,u){const f=s.resources.length,v=s.random?Math.floor(Math.random()*f):s.index;let p;if(s.random){let W=s.resources.slice(0);for(p=[];W.length>1;){const N=Math.floor(Math.random()*W.length);p.push(W[N]),W=W.slice(0,N).concat(W.slice(N+1))}p=p.concat(W)}else p=s.resources.slice(v).concat(s.resources.slice(0,v));const D=Date.now();let E="pending",M=0,A,F=null,P=[],Y=[];typeof u=="function"&&Y.push(u);function H(){F&&(clearTimeout(F),F=null)}function Q(){E==="pending"&&(E="aborted"),H(),P.forEach(W=>{W.status==="pending"&&(W.status="aborted")}),P=[]}function Z(W,N){N&&(Y=[]),typeof W=="function"&&Y.push(W)}function G(){return{startTime:D,payload:o,status:E,queriesSent:M,queriesPending:P.length,subscribe:Z,abort:Q}}function j(){E="failed",Y.forEach(W=>{W(void 0,A)})}function z(){P.forEach(W=>{W.status==="pending"&&(W.status="aborted")}),P=[]}function q(W,N,oe){const he=N!=="success";switch(P=P.filter(se=>se!==W),E){case"pending":break;case"failed":if(he||!s.dataAfterTimeout)return;break;default:return}if(N==="abort"){A=oe,j();return}if(he){A=oe,P.length||(p.length?B():j());return}if(H(),z(),!s.random){const se=s.resources.indexOf(W.resource);se!==-1&&se!==s.index&&(s.index=se)}E="completed",Y.forEach(se=>{se(oe)})}function B(){if(E!=="pending")return;H();const W=p.shift();if(W===void 0){if(P.length){F=setTimeout(()=>{H(),E==="pending"&&(z(),j())},s.timeout);return}j();return}const N={status:"pending",resource:W,callback:(oe,he)=>{q(N,oe,he)}};P.push(N),M++,F=setTimeout(B,s.rotate),i(W,o,N.callback)}return setTimeout(B),G}function mi(s){const o={...cs,...s};let i=[];function u(){i=i.filter(D=>D().status==="pending")}function f(D,E,M){const A=fs(o,D,E,(F,P)=>{u(),M&&M(F,P)});return i.push(A),A}function v(D){return i.find(E=>D(E))||null}return{query:f,find:v,setIndex:D=>{o.index=D},getIndex:()=>o.index,cleanup:u}}function Qo(){}const Lr=Object.create(null);function ds(s){if(!Lr[s]){const o=no(s);if(!o)return;const i=mi(o),u={config:o,redundancy:i};Lr[s]=u}return Lr[s]}function hs(s,o,i){let u,f;if(typeof s=="string"){const v=Gr(s);if(!v)return i(void 0,424),Qo;f=v.send;const p=ds(s);p&&(u=p.redundancy)}else{const v=eo(s);if(v){u=mi(v);const p=s.resources?s.resources[0]:"",D=Gr(p);D&&(f=D.send)}}return!u||!f?(i(void 0,424),Qo):u.query(o,f,i)().abort}function Go(){}function vs(s){s.iconsLoaderFlag||(s.iconsLoaderFlag=!0,setTimeout(()=>{s.iconsLoaderFlag=!1,as(s)}))}function ps(s){const o=[],i=[];return s.forEach(u=>{(u.match(ui)?o:i).push(u)}),{valid:o,invalid:i}}function mn(s,o,i){function u(){const f=s.pendingIcons;o.forEach(v=>{f&&f.delete(v),s.icons[v]||s.missing.add(v)})}if(i&&typeof i=="object")try{if(!di(s,i).length){u();return}}catch(f){console.error(f)}u(),vs(s)}function Xo(s,o){s instanceof Promise?s.then(i=>{o(i)}).catch(()=>{o(null)}):o(s)}function gs(s,o){s.iconsToLoad?s.iconsToLoad=s.iconsToLoad.concat(o).sort():s.iconsToLoad=o,s.iconsQueueFlag||(s.iconsQueueFlag=!0,setTimeout(()=>{s.iconsQueueFlag=!1;const{provider:i,prefix:u}=s,f=s.iconsToLoad;if(delete s.iconsToLoad,!f||!f.length)return;const v=s.loadIcon;if(s.loadIcons&&(f.length>1||!v)){Xo(s.loadIcons(f,u,i),A=>{mn(s,f,A)});return}if(v){f.forEach(A=>{const F=v(A,u,i);Xo(F,P=>{const Y=P?{prefix:u,icons:{[A]:P}}:null;mn(s,[A],Y)})});return}const{valid:p,invalid:D}=ps(f);if(D.length&&mn(s,D,null),!p.length)return;const E=u.match(ui)?Gr(i):null;if(!E){mn(s,p,null);return}E.prepare(i,u,p).forEach(A=>{hs(i,A,F=>{mn(s,A.icons,F)})})}))}const ms=(s,o)=>{const i=ls(s,!0,hi()),u=is(i);if(!u.pending.length){let E=!0;return o&&setTimeout(()=>{E&&o(u.loaded,u.missing,u.pending,Go)}),()=>{E=!1}}const f=Object.create(null),v=[];let p,D;return u.pending.forEach(E=>{const{provider:M,prefix:A}=E;if(A===D&&M===p)return;p=M,D=A,v.push(an(M,A));const F=f[M]||(f[M]=Object.create(null));F[A]||(F[A]=[])}),u.pending.forEach(E=>{const{provider:M,prefix:A,name:F}=E,P=an(M,A),Y=P.pendingIcons||(P.pendingIcons=new Set);Y.has(F)||(Y.add(F),f[M][A].push(F))}),v.forEach(E=>{const M=f[E.provider][E.prefix];M.length&&gs(E,M)}),o?us(o,u,v):Go};function ys(s,o){const i={...s};for(const u in o){const f=o[u],v=typeof f;u in vi?(f===null||f&&(v==="string"||v==="number"))&&(i[u]=f):v===typeof i[u]&&(i[u]=u==="rotate"?f%4:f)}return i}const bs=/[\s,]+/;function _s(s,o){o.split(bs).forEach(i=>{switch(i.trim()){case"horizontal":s.hFlip=!0;break;case"vertical":s.vFlip=!0;break}})}function ws(s,o=0){const i=s.replace(/^-?[0-9.]*/,"");function u(f){for(;f<0;)f+=4;return f%4}if(i===""){const f=parseInt(s);return isNaN(f)?0:u(f)}else if(i!==s){let f=0;switch(i){case"%":f=25;break;case"deg":f=90}if(f){let v=parseFloat(s.slice(0,s.length-i.length));return isNaN(v)?0:(v=v/f,v%1===0?u(v):0)}}return o}function xs(s,o){let i=s.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const u in o)i+=" "+u+'="'+o[u]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+i+">"+s+"</svg>"}function ks(s){return s.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Ds(s){return"data:image/svg+xml,"+ks(s)}function Ss(s){return'url("'+Ds(s)+'")'}const Jo={...pi,inline:!1},Ts={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Es={display:"inline-block"},Xr={"background-color":"currentColor"},yi={"background-color":"transparent"},Zo={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},$o={"-webkit-mask":Xr,mask:Xr,background:yi};for(const s in $o){const o=$o[s];for(const i in Zo)o[s+"-"+i]=Zo[i]}function Os(s){return s+(s.match(/^[-0-9.]+$/)?"px":"")}function Cs(s,o){const i=ys(Jo,o),u=o.mode||"svg",f=u==="svg"?{...Ts}:{};s.body.indexOf("xlink:")===-1&&delete f["xmlns:xlink"];let v=typeof o.style=="string"?o.style:"";for(let G in o){const j=o[G];if(j!==void 0)switch(G){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":i[G]=j===!0||j==="true"||j===1;break;case"flip":typeof j=="string"&&_s(i,j);break;case"color":v=v+(v.length>0&&v.trim().slice(-1)!==";"?";":"")+"color: "+j+"; ";break;case"rotate":typeof j=="string"?i[G]=ws(j):typeof j=="number"&&(i[G]=j);break;case"ariaHidden":case"aria-hidden":j!==!0&&j!=="true"&&delete f["aria-hidden"];break;default:if(G.slice(0,3)==="on:")break;Jo[G]===void 0&&(f[G]=j)}}const p=Ya(s,i),D=p.attributes;if(i.inline&&(v="vertical-align: -0.125em; "+v),u==="svg"){Object.assign(f,D),v!==""&&(f.style=v);let G=0,j=o.id;return typeof j=="string"&&(j=j.replace(/-/g,"_")),{svg:!0,attributes:f,body:Ga(p.body,j?()=>j+"ID"+G++:"iconifySvelte")}}const{body:E,width:M,height:A}=s,F=u==="mask"||(u==="bg"?!1:E.indexOf("currentColor")!==-1),P=xs(E,{...D,width:M+"",height:A+""}),H={"--svg":Ss(P)},Q=G=>{const j=D[G];j&&(H[G]=Os(j))};Q("width"),Q("height"),Object.assign(H,Es,F?Xr:yi);let Z="";for(const G in H)Z+=G+": "+H[G]+";";return f.style=Z+v,{svg:!1,attributes:f}}hi(!0);Xa("",os);if(typeof document<"u"&&typeof window<"u"){const s=window;if(s.IconifyPreload!==void 0){const o=s.IconifyPreload,i="Invalid IconifyPreload syntax.";typeof o=="object"&&o!==null&&(o instanceof Array?o:[o]).forEach(u=>{try{(typeof u!="object"||u===null||u instanceof Array||typeof u.icons!="object"||typeof u.prefix!="string"||!Ra(u))&&console.error(i)}catch{console.error(i)}})}if(s.IconifyProviders!==void 0){const o=s.IconifyProviders;if(typeof o=="object"&&o!==null)for(let i in o){const u="IconifyProviders["+i+"] is invalid.";try{const f=o[i];if(typeof f!="object"||!f||f.resources===void 0)continue;Ja(i,f)||console.error(u)}catch{console.error(u)}}}}function Ps(s,o,i,u,f){function v(){o.loading&&(o.loading.abort(),o.loading=null)}if(typeof s=="object"&&s!==null&&typeof s.body=="string")return o.name="",v(),{data:{...ir,...s}};let p;if(typeof s!="string"||(p=or(s,!1,!0))===null)return v(),null;const D=Fa(p);if(!D)return i&&(!o.loading||o.loading.name!==s)&&(v(),o.name="",o.loading={name:s,abort:ms([p],u)}),null;v(),o.name!==s&&(o.name=s,f&&!o.destroyed&&f(s));const E=["iconify"];return p.prefix!==""&&E.push("iconify--"+p.prefix),p.provider!==""&&E.push("iconify--"+p.provider),{data:D,classes:E}}function Is(s,o){return s?Cs({...ir,...s},o):null}var js=pa("<svg><!></svg>"),As=xe("<span></span>");function lt(s,o){rt(o,!0);const i={name:"",loading:null,destroyed:!1},u=ya(o,["$$slots","$$events","$$legacy"]);let f=Ce(!1),v=Ce(0),p=Ce(null);ha(()=>{C(v);const F=!!o.ssr||C(f),P=Ps(o.icon,i,F,D,o.onload),Y=P?Is(P.data,u):null;Y&&P.classes&&(Y.attributes.class=(typeof u.class=="string"?u.class+" ":"")+P.classes.join(" ")),ue(p,Y,!0)});function D(){va(v)}Jr(()=>{ue(f,!0)}),Yi(()=>{i.destroyed=!0,i.loading&&(i.loading.abort(),i.loading=null)});var E=bn(),M=dt(E);{var A=F=>{var P=bn(),Y=dt(P);{var H=Z=>{var G=js();Bo(G,()=>({...C(p).attributes}));var j=R(G);ka(j,()=>C(p).body,!0),K(G),ve(Z,G)},Q=Z=>{var G=As();Bo(G,()=>({...C(p).attributes})),ve(Z,G)};nt(Y,Z=>{C(p).svg?Z(H):Z(Q,!1)})}ve(F,P)};nt(M,F=>{C(p)&&F(A)})}ve(s,E),ot()}var Ms=xe('<div class="hour svelte-efxz8w"></div>'),Ks=xe('<div class="day svelte-efxz8w"><!></div>'),Fs=xe('<p class="day svelte-efxz8w"> </p> <!>',1),qs=xe('<div class="day svelte-efxz8w"><div class="hour svelte-efxz8w"></div></div>'),Rs=xe('<div class="daynight svelte-efxz8w"><!> <p class="svelte-efxz8w"><a href="https://sunrise-sunset.org" target="_blank" class="svelte-efxz8w"> </a></p></div>'),Bs=xe('<figure class="svelte-efxz8w"><div class="labels svelte-efxz8w"><p class="date svelte-efxz8w">Date</p> <p class="hour svelte-efxz8w">0</p> <p class="hour svelte-efxz8w">12</p> <p class="hour svelte-efxz8w">24</p></div> <div class="grid svelte-efxz8w"><!></div> <div class="average grid svelte-efxz8w"><p class="day svelte-efxz8w">Avg</p> <!></div> <legend class="svelte-efxz8w"><!> <div class="color svelte-efxz8w"></div> <p class="svelte-efxz8w">Fasting</p></legend></figure>');function bi(s,o){rt(o,!0);let i=Te(o,"average",19,()=>[]),u=Te(o,"daily",3,null);Te(o,"days",3,10);let f=Ce(null),v=Ce(null),p=Ve(()=>C(v)===null?null:C(v).getTime()<Date.now()?"material-symbols:moon-stars-outline-rounded":"material-symbols:wb-sunny-outline-rounded");Jr(()=>{setInterval(()=>D(),36e5),D()});function D(){navigator.geolocation.getCurrentPosition(B=>{fetch(`https://api.sunrise-sunset.org/json?lat=${B.latitude}&lng=${B.longitude}&date=today`).then(W=>W.json()).then(W=>{ue(f,new Date(E(W.results.sunrise).getTime()),!0),ue(v,new Date(E(W.results.sunset).getTime()),!0),Date.now()>C(v).getTime()&&fetch(`https://api.sunrise-sunset.org/json?lat=${B.latitude}&lng=${B.longitude}&date=tomorrow`).then(N=>N.json()).then(N=>{ue(f,new Date(E(N.results.sunrise).getTime()),!0),ue(v,new Date(E(N.results.sunset).getTime()),!0)})})},B=>{console.log(B)})}function E(B){const W=B.match(/(\d+):(\d+):(\d+)\s*(AM|PM)/i);let N=parseInt(W[1],10);const oe=parseInt(W[2],10),he=parseInt(W[3],10),se=W[4].toUpperCase();se==="PM"&&N!==12?N+=12:se==="AM"&&N===12&&(N=0);const me=new Date;return me.setHours(N,oe,he,0),me}function M(B){return B=new Date(B+"T00:00:00"),new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric"}).format(B)}function A(B){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(B)}function F(B,W){return B===0||W[B-1]===0?(1-W[B])*100+"%":0}var P=Bs(),Y=te(R(P),2),H=R(Y);{var Q=B=>{var W=bn(),N=dt(W);Ut(N,17,()=>Object.keys(u()),Lt,(oe,he)=>{var se=Fs();const me=Ve(()=>u()[C(he)]);var Ee=dt(se),Fe=R(Ee,!0);K(Ee);var Ne=te(Ee,2);Ut(Ne,16,()=>({length:24}),Lt,(Re,Ue,ye)=>{var ce=Ks(),Be=R(ce);{var je=Ye=>{var Qe=Ms();let We;Ke(ht=>We=No(Qe,"",We,ht),[()=>({"margin-left":F(ye,C(me)),width:100*C(me)[ye]+"%"})]),ve(Ye,Qe)};nt(Be,Ye=>{C(me)[ye]!==0&&Ye(je)})}K(ce),ve(Re,ce)}),Ke(Re=>we(Fe,Re),[()=>M(C(he))]),ve(oe,se)}),ve(B,W)};nt(H,B=>{u()!==null&&B(Q)})}K(Y);var Z=te(Y,2),G=te(R(Z),2);Ut(G,16,()=>({length:24}),Lt,(B,W,N)=>{var oe=qs(),he=R(oe);let se;K(oe),Ke(me=>se=No(he,"",se,me),[()=>({opacity:i()[N],width:"100%"})]),ve(B,oe)}),K(Z);var j=te(Z,2),z=R(j);{var q=B=>{var W=Rs(),N=R(W);lt(N,{color:"#0284c7",height:"16",get icon(){return C(p)},width:"16"});var oe=te(N,2),he=R(oe),se=R(he,!0);K(he),K(oe),K(W),Ke(me=>we(se,me),[()=>A(Date.now()>C(f).getTime()?C(v):C(f))]),ve(B,W)};nt(z,B=>{C(p)!==null&&B(q)})}Gn(4),K(j),K(P),ve(s,P),ot()}var Ns=xe('<article class="svelte-10tx4k0"><p class="svelte-10tx4k0"><span class="svelte-10tx4k0"> </span> <span class="units svelte-10tx4k0">hrs</span></p> <p class="colon svelte-10tx4k0">:</p> <p class="svelte-10tx4k0"><span class="svelte-10tx4k0"> </span> <span class="units svelte-10tx4k0">min</span></p> <p class="colon svelte-10tx4k0">:</p> <p class="svelte-10tx4k0"><span class="svelte-10tx4k0"> </span> <span class="units svelte-10tx4k0">sec</span></p></article>');function Hs(s,o){rt(o,!0);let i=Te(o,"now",3,null),u=Te(o,"started",3,null),f=Ve(()=>{if(u()===null)return{hours:0,minutes:"00",seconds:"00"};const Q=Math.floor((i()-u().getTime())/1e3);return{hours:Math.floor(Q/3600).toString(10).padStart(2,"0"),minutes:Math.floor(Q%3600/60).toString(10).padStart(2,"0"),seconds:(Q%60).toString(10).padStart(2,"0")}});var v=Ns(),p=R(v),D=R(p),E=R(D,!0);K(D),Gn(2),K(p);var M=te(p,4),A=R(M),F=R(A,!0);K(A),Gn(2),K(M);var P=te(M,4),Y=R(P),H=R(Y,!0);K(Y),Gn(2),K(P),K(v),Ke(()=>{we(E,C(f).hours),we(F,C(f).minutes),we(H,C(f).seconds)}),ve(s,v),ot()}function zs(s,o,i){o()===null?i.onstart&&i.onstart():i.onend&&i.onend()}var Ls=xe('<p class="svelte-81vq7f">You are not fasting.</p>'),Us=xe('<p class="svelte-81vq7f">You are fasting.</p> <!> <p class="started svelte-81vq7f"> </p>',1),Ys=xe('<section class="svelte-81vq7f"><header class="svelte-81vq7f"><h3 class="svelte-81vq7f">Fasting</h3> <button type="button" class="svelte-81vq7f"><!></button></header> <article class="svelte-81vq7f"><!> <button class="primary svelte-81vq7f" type="button"> </button></article> <article class="svelte-81vq7f"><!></article> <footer class="svelte-81vq7f"><button class="hunger secondary svelte-81vq7f" type="button"><!> <span> </span></button> <button class="water secondary svelte-81vq7f" type="button"><!> <span> </span></button></footer></section>');function Ws(s,o){rt(o,!0);let i=Te(o,"activity",3,null),u=Te(o,"hunger",3,5),f=Te(o,"levels",19,()=>[]),v=Te(o,"now",3,null),p=Te(o,"started",3,null),D=Te(o,"water",3,0);function E(ye){return f().find(Be=>Be.value===ye).label}function M(ye){return ye===null?null:new Intl.DateTimeFormat(navigator.language,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}).format(ye)}var A=Ys(),F=R(A),P=te(R(F),2);P.__click=function(...ye){var ce;(ce=o.onsettings)==null||ce.apply(this,ye)};var Y=R(P);lt(Y,{height:"20",icon:"material-symbols:settings-outline",width:"20"}),K(P),K(F);var H=te(F,2),Q=R(H);{var Z=ye=>{var ce=Ls();ve(ye,ce)},G=ye=>{var ce=Us(),Be=te(dt(ce),2);Hs(Be,{get now(){return v()},get started(){return p()}});var je=te(Be,2),Ye=R(je);K(je),Ke(Qe=>we(Ye,`Started ${Qe??""}`),[()=>M(p())]),ve(ye,ce)};nt(Q,ye=>{p()===null?ye(Z):ye(G,!1)})}var j=te(Q,2);j.__click=[zs,p,o];var z=R(j);K(j),K(H);var q=te(H,2),B=R(q);const W=Ve(()=>i()===null?[]:i().average),N=Ve(()=>i()===null?null:i().daily);bi(B,{get average(){return C(W)},get daily(){return C(N)},days:7}),K(q);var oe=te(q,2),he=R(oe);he.__click=function(...ye){var ce;(ce=o.onhunger)==null||ce.apply(this,ye)};var se=R(he);lt(se,{height:"20",icon:"material-symbols:fork-spoon-rounded",width:"20"});var me=te(se,2),Ee=R(me,!0);K(me),K(he);var Fe=te(he,2);Fe.__click=function(...ye){var ce;(ce=o.onwater)==null||ce.apply(this,ye)};var Ne=R(Fe);lt(Ne,{height:"20",icon:"material-symbols:water-drop-outline-rounded",width:"20"});var Re=te(Ne,2),Ue=R(Re);K(Re),K(Fe),K(oe),K(A),Ke(ye=>{we(z,`${p()===null?"Start":"Stop"} fasting`),we(Ee,ye),we(Ue,`${D()??""} oz`)},[()=>E(u())]),ve(s,A),ot()}gt(["click"]);function Vs(s,o,i,u){const f=new Date(parseInt(s.currentTarget.getAttribute("data-year")),parseInt(s.currentTarget.getAttribute("data-month")),parseInt(s.currentTarget.getAttribute("data-date")));f.getMonth()!==o().getMonth()&&o(new Date(f.getTime())),i(new Date(f.getTime())),u.onchange&&u.onchange(i())}var Qs=xe('<button type="button"> </button>'),Gs=xe('<section><header class="svelte-1ll096s"><h3 class="svelte-1ll096s"> </h3> <button type="button" class="svelte-1ll096s"><!></button> <button type="button" class="svelte-1ll096s"><!></button></header> <article class="svelte-1ll096s"><p class="svelte-1ll096s">Sun</p> <p class="svelte-1ll096s">Mon</p> <p class="svelte-1ll096s">Tue</p> <p class="svelte-1ll096s">Wed</p> <p class="svelte-1ll096s">Thu</p> <p class="svelte-1ll096s">Fri</p> <p class="svelte-1ll096s">Sat</p></article> <article class="svelte-1ll096s"></article></section>');function Xs(s,o){rt(o,!0);let i=Te(o,"display",23,()=>new Date),u=Te(o,"value",23,()=>new Date),f=Ve(()=>new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(i())),v=Ve(()=>{const G=[],j=new Date,z=new Date(i().getFullYear(),i().getMonth(),1);z.setDate(z.getDate()-z.getDay());for(let q=0;q<42;q++){const B={date:z.getDate(),month:z.getMonth(),year:z.getFullYear(),outside:!0,today:!1,selected:!1,after:!1};z.getFullYear()===i().getFullYear()&&z.getMonth()===i().getMonth()&&(B.outside=!1),z.getTime()>Date.now()&&(B.after=!0),z.getFullYear()===j.getFullYear()&&z.getMonth()===j.getMonth()&&z.getDate()===j.getDate()&&(B.today=!0),z.getFullYear()===u().getFullYear()&&z.getMonth()===u().getMonth()&&z.getDate()===u().getDate()&&(B.selected=!0),z.setDate(z.getDate()+1),G.push(B)}return G});function p(){let G=i().getMonth(),j=i().getFullYear();j=G===0?j-1:j,G=G===0?11:G-1,i(new Date(j,G,i().getDate()))}function D(){let G=i().getMonth(),j=i().getFullYear();j=G===11?j+1:j,G=(G+1)%12,i(new Date(j,G,i().getDate()))}var E=Gs(),M=R(E),A=R(M),F=R(A,!0);K(A);var P=te(A,2);P.__click=p;var Y=R(P);lt(Y,{height:"24",icon:"material-symbols:navigate-before",width:"24"}),K(P);var H=te(P,2);H.__click=D;var Q=R(H);lt(Q,{height:"24",icon:"material-symbols:navigate-next",width:"24"}),K(H),K(M);var Z=te(M,4);Ut(Z,21,()=>C(v),Lt,(G,j)=>{var z=Qs();z.__click=[Vs,i,u,o];let q;var B=R(z,!0);K(z),Ke(W=>{Jn(z,"data-year",C(j).year),Jn(z,"data-month",C(j).month),Jn(z,"data-date",C(j).date),z.disabled=C(j).after,q=Yt(z,1,"svelte-1ll096s",null,q,W),we(B,C(j).date)},[()=>({outside:C(j).outside,today:C(j).today,selected:C(j).selected})]),ve(G,z)}),K(Z),K(E),Ke(()=>we(F,C(f))),ve(s,E),ot()}gt(["click"]);function Js(s,o,i){const u=new Date(o().getTime());u.getHours()>=12?u.getHours()===12?u.setHours(23):u.setHours(u.getHours()-1):u.getHours()===0?u.setHours(11):u.setHours(u.getHours()-1),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}function Zs(s,o,i){const u=new Date(o().getTime());u.getHours()>=12?u.getHours()===23?u.setHours(12):u.setHours(u.getHours()+1):u.getHours()===11?u.setHours(0):u.setHours(u.getHours()+1),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}function $s(s,o,i){const u=new Date(o().getTime());u.getHours()>=12&&u.setHours(u.getHours()-12),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}function eu(s,o,i){const u=new Date(o().getTime());u.getHours()<12&&u.setHours(u.getHours()+12),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}function tu(s,o,i){const u=new Date(o().getTime());u.getMinutes()===0?u.setMinutes(59):u.setMinutes(u.getMinutes()-1),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}function nu(s,o,i){const u=new Date(o().getTime());u.getMinutes()===59?u.setMinutes(0):u.setMinutes(u.getMinutes()+1),o(new Date(u.getTime())),i.onchange&&i.onchange(o())}var ru=xe('<article class="svelte-1bevvpj"><div class="time svelte-1bevvpj"><div class="dial svelte-1bevvpj"><button type="button" class="svelte-1bevvpj"><!></button> <p class="svelte-1bevvpj"> </p> <button type="button" class="svelte-1bevvpj"><!></button></div> <p class="svelte-1bevvpj">:</p> <div class="dial svelte-1bevvpj"><button type="button" class="svelte-1bevvpj"><!></button> <p class="svelte-1bevvpj"> </p> <button type="button" class="svelte-1bevvpj"><!></button></div></div> <div class="meridian svelte-1bevvpj"><button type="button">AM</button> <button type="button">PM</button></div></article>');function ou(s,o){rt(o,!0);let i=Te(o,"value",23,()=>new Date),u=Ve(()=>i().getHours()%12||12),f=Ve(()=>i().getMinutes().toString(10).padStart(2,"0")),v=Ve(()=>i().getHours()>=12?"PM":"AM");var p=ru(),D=R(p),E=R(D),M=R(E);M.__click=[Zs,i,o];var A=R(M);lt(A,{height:"24",icon:"material-symbols:keyboard-arrow-up-rounded",width:"24"}),K(M);var F=te(M,2),P=R(F,!0);K(F);var Y=te(F,2);Y.__click=[Js,i,o];var H=R(Y);lt(H,{height:"24",icon:"material-symbols:keyboard-arrow-down-rounded",width:"24"}),K(Y),K(E);var Q=te(E,4),Z=R(Q);Z.__click=[nu,i,o];var G=R(Z);lt(G,{height:"24",icon:"material-symbols:keyboard-arrow-up-rounded",width:"24"}),K(Z);var j=te(Z,2),z=R(j,!0);K(j);var q=te(j,2);q.__click=[tu,i,o];var B=R(q);lt(B,{height:"24",icon:"material-symbols:keyboard-arrow-down-rounded",width:"24"}),K(q),K(Q),K(D);var W=te(D,2),N=R(W);N.__click=[$s,i,o];let oe;var he=te(N,2);he.__click=[eu,i,o];let se;K(W),K(p),Ke((me,Ee)=>{we(P,C(u)),we(z,C(f)),oe=Yt(N,1,"svelte-1bevvpj",null,oe,me),se=Yt(he,1,"svelte-1bevvpj",null,se,Ee)},[()=>({selected:C(v)==="AM"}),()=>({selected:C(v)==="PM"})]),ve(s,p),ot()}gt(["click"]);function iu(s,o){ue(o,"calendar")}function au(s,o){ue(o,"clock")}var su=xe('<article class="svelte-8yzu2w"><header class="svelte-8yzu2w"><button type="button"><p class="svelte-8yzu2w"> </p> <p class="svelte-8yzu2w"> </p></button> <button type="button"><p class="svelte-8yzu2w"> </p></button></header> <!></article>');function uu(s,o){rt(o,!0);let i=Te(o,"value",23,()=>new Date),u=Ce("calendar");function f(N){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric"}).format(N)}function v(N){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(N)}function p(N){N.setHours(i().getHours()),N.setMinutes(i().getMinutes()),N.setSeconds(i().getSeconds()),i(new Date(N.getTime())),o.onchange&&o.onchange(i())}function D(N){N.setFullYear(i().getFullYear()),N.getMonth(i().getMonth()),N.getDate(i().getDate()),i(new Date(N.getTime())),o.onchange&&o.onchange(i())}var E=su(),M=R(E),A=R(M);A.__click=[iu,u];let F;var P=R(A),Y=R(P,!0);K(P);var H=te(P,2),Q=R(H,!0);K(H),K(A);var Z=te(A,2);Z.__click=[au,u];let G;var j=R(Z),z=R(j,!0);K(j),K(Z),K(M);var q=te(M,2);{var B=N=>{Xs(N,{onchange:p,get value(){return i()}})},W=N=>{ou(N,{onchange:D,get value(){return i()}})};nt(q,N=>{C(u)===null||C(u)==="calendar"?N(B):N(W,!1)})}K(E),Ke((N,oe,he,se)=>{F=Yt(A,1,"svelte-8yzu2w",null,F,N),we(Y,o.label),we(Q,oe),G=Yt(Z,1,"svelte-8yzu2w",null,G,he),we(z,se)},[()=>({selected:C(u)==="calendar"}),()=>f(i()),()=>({selected:C(u)==="clock"}),()=>v(i())]),ve(s,E),ot()}gt(["click"]);function lu(s,o,i,u){o(),i(null),u.oncancel&&u.oncancel()}function cu(s,o,i){o.ondelete&&o.ondelete(i().id)}function fu(s,o){const i=s.currentTarget.value.trim().length===0?null:s.currentTarget.value;o({...o(),notes:i})}function du(s,o,i){o.onsave&&o.onsave(i())}var hu=xe('<dialog class="svelte-13glclx"><h3 class="svelte-13glclx"> </h3> <!> <textarea placeholder="Notes" class="svelte-13glclx"></textarea> <footer class="svelte-13glclx"><button class="delete svelte-13glclx" type="button">Delete</button> <button class="cancel svelte-13glclx" type="button">Cancel</button> <button type="button" class="svelte-13glclx">Save</button></footer></dialog>');function vu(s,o){rt(o,!0);let i=Te(o,"field",3,"started"),u=Te(o,"item",7,null),f=Te(o,"label",3,"Started"),v=Te(o,"title",3,"Edit Fast Start"),p=Ce(void 0);function D(q){const B={...u()};B[i()]=new Date(q.getTime()),u({...B})}function E(){C(p).close()}function M(){C(p).showModal()}var A=hu(),F=R(A),P=R(F,!0);K(F);var Y=te(F,2);const H=Ve(()=>u()&&u().id&&u().id!==null?u()[i()]:new Date);uu(Y,{get label(){return f()},onchange:D,get value(){return C(H)}});var Q=te(Y,2);ga(Q),Q.__input=[fu,u];var Z=te(Q,2),G=R(Z);G.__click=[cu,o,u];var j=te(G,2);j.__click=[lu,E,u,o];var z=te(j,2);return z.__click=[du,o,u],K(Z),K(A),At(A,q=>ue(p,q),()=>C(p)),Ke(()=>{we(P,v()),ma(Q,u()&&u().id&&u().id!==null?u().notes:"")}),ve(s,A),ot({close:E,showModal:M})}gt(["input","click"]);var pu=xe('<article class="svelte-o2f930"><p class="svelte-o2f930">Your fasting history<br/>will be displayed here.</p></article>'),gu=xe('<li class="header svelte-o2f930"><p class="svelte-o2f930"> </p></li>'),mu=(s,o,i)=>o(C(i).type,C(i).id),yu=xe('<p class="svelte-o2f930">Started Fast</p> <p class="svelte-o2f930"></p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p>',1),bu=xe('<p class="svelte-o2f930">Water</p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p>',1),_u=xe('<p class="svelte-o2f930"> </p> <p class="svelte-o2f930"></p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p>',1),wu=xe('<p class="svelte-o2f930">Ended Fast</p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p> <p class="svelte-o2f930"> </p>',1),xu=xe('<li class="svelte-o2f930"><button type="button" class="svelte-o2f930"><!></button></li>'),ku=xe('<ul class="svelte-o2f930"></ul>');function Du(s,o){rt(o,!0);let i=Te(o,"items",19,()=>[]);function u(P){return new Intl.DateTimeFormat(navigator.language,{month:"short",day:"numeric",year:"numeric"}).format(P)}function f(P,Y){const H=Y.getTime()-P.getTime(),Q=Math.floor(H/1e3),Z=Math.floor(Q/3600),G=Math.floor(Q%3600/60);return new Intl.DurationFormat(navigator.language,{style:"short",units:["hour","minute"]}).format({hours:Z,minutes:G})}function v(P){return new Intl.DateTimeFormat(navigator.language,{weekday:"long",month:"short",day:"numeric"}).format(P)}function p(P){return new Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"2-digit"}).format(P)}function D(P,Y){o.onchange&&o.onchange(P,Y)}var E=bn(),M=dt(E);{var A=P=>{var Y=pu();ve(P,Y)},F=P=>{var Y=ku();Ut(Y,21,i,Lt,(H,Q)=>{var Z=bn(),G=dt(Z);{var j=q=>{var B=gu(),W=R(B),N=R(W,!0);K(W),K(B),Ke(oe=>we(N,oe),[()=>v(C(Q).timed)]),ve(q,B)},z=q=>{var B=xu(),W=R(B);W.__click=[mu,D,Q];var N=R(W);{var oe=se=>{var me=yu(),Ee=te(dt(me),4),Fe=R(Ee,!0);K(Ee);var Ne=te(Ee,2),Re=R(Ne,!0);K(Ne),Ke((Ue,ye)=>{we(Fe,Ue),we(Re,ye)},[()=>u(C(Q).timed),()=>p(C(Q).timed)]),ve(se,me)},he=(se,me)=>{{var Ee=Ne=>{var Re=bu(),Ue=te(dt(Re),2),ye=R(Ue);K(Ue);var ce=te(Ue,2),Be=R(ce,!0);K(ce);var je=te(ce,2),Ye=R(je,!0);K(je),Ke((Qe,We)=>{we(ye,`${C(Q).volume??""} oz`),we(Be,Qe),we(Ye,We)},[()=>u(C(Q).timed),()=>p(C(Q).timed)]),ve(Ne,Re)},Fe=(Ne,Re)=>{{var Ue=ce=>{var Be=_u(),je=dt(Be),Ye=R(je,!0);K(je);var Qe=te(je,4),We=R(Qe,!0);K(Qe);var ht=te(Qe,2),at=R(ht,!0);K(ht),Ke((it,ct)=>{we(Ye,C(Q).level),we(We,it),we(at,ct)},[()=>u(C(Q).timed),()=>p(C(Q).timed)]),ve(ce,Be)},ye=(ce,Be)=>{{var je=Ye=>{var Qe=wu(),We=te(dt(Qe),2),ht=R(We,!0);K(We);var at=te(We,2),it=R(at,!0);K(at);var ct=te(at,2),Wt=R(ct,!0);K(ct),Ke((ie,Vt,mt)=>{we(ht,ie),we(it,Vt),we(Wt,mt)},[()=>f(C(Q).started,C(Q).ended),()=>u(C(Q).timed),()=>p(C(Q).timed)]),ve(Ye,Qe)};nt(ce,Ye=>{C(Q).type==="end"&&Ye(je)},Be)}};nt(Ne,ce=>{C(Q).type==="hunger"?ce(Ue):ce(ye,!1)},Re)}};nt(se,Ne=>{C(Q).type==="water"?Ne(Ee):Ne(Fe,!1)},me)}};nt(N,se=>{C(Q).type==="start"?se(oe):se(he,!1)})}K(W),K(B),ve(q,B)};nt(G,q=>{C(Q).type==="header"?q(j):q(z,!1)})}ve(H,Z)}),K(Y),ve(P,Y)};nt(M,P=>{i().length===0?P(A):P(F,!1)})}ve(s,E),ot()}gt(["click"]);var Su=xe('<section class="svelte-jsa4zq"><header class="svelte-jsa4zq"><h3 class="svelte-jsa4zq">Hours</h3></header> <article class="svelte-jsa4zq"><!></article> <article class="svelte-jsa4zq"><!></article></section>');function Tu(s,o){rt(o,!0);let i=Te(o,"activity",3,null),u=Te(o,"history",19,()=>[]);Te(o,"levels",19,()=>[]);var f=Su(),v=te(R(f),2),p=R(v);const D=Ve(()=>i()===null?[]:i().average),E=Ve(()=>i()===null?null:i().daily);bi(p,{get average(){return C(D)},get daily(){return C(E)},days:7}),K(v);var M=te(v,2),A=R(M);Du(A,{get items(){return u()},get onchange(){return o.onchange}}),K(M),K(f),ve(s,f),ot()}function Eu(s,o,i,u){o(),i(null),u.oncancel&&u.oncancel()}function Ou(s,o,i){o.ondelete&&o.ondelete(i().id)}function Cu(s,o,i){o()===null&&o({...o(),level:5}),i.onsave&&i.onsave(o())}var Pu=(s,o,i)=>o(C(i).value),Iu=xe('<li class="svelte-1gyfgoj"><button type="button" class="svelte-1gyfgoj"><p class="svelte-1gyfgoj"> </p> <!></button></li>'),ju=xe('<button class="delete svelte-1gyfgoj" type="button">Delete</button>'),Au=xe('<dialog class="svelte-1gyfgoj"><h3 class="svelte-1gyfgoj"> </h3> <ul class="svelte-1gyfgoj"></ul> <footer class="svelte-1gyfgoj"><!> <button class="cancel svelte-1gyfgoj" type="button">Cancel</button> <button type="button" class="svelte-1gyfgoj">Save</button></footer></dialog>');function Mu(s,o){rt(o,!0);let i=Te(o,"item",7,null),u=Te(o,"levels",19,()=>[]);Te(o,"units",3,"oz");let f=Ce(void 0),v=Ve(()=>i()&&i().level&&i().level!==null?i().level:5);function p(j){const z=j;i({...i(),level:z})}function D(){C(f).close()}function E(){C(f).showModal()}var M=Au(),A=R(M),F=R(A);K(A);var P=te(A,2);Ut(P,21,u,Lt,(j,z)=>{var q=Iu();const B=Ve(()=>C(z).value===C(v)?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");var W=R(q);W.__click=[Pu,p,z];var N=R(W),oe=R(N,!0);K(N);var he=te(N,2);const se=Ve(()=>C(z).value===C(v)?"#0284c7":"#161616");lt(he,{get color(){return C(se)},height:"20",get icon(){return C(B)},width:"20"}),K(W),K(q),Ke(()=>we(oe,C(z).label)),ve(j,q)}),K(P);var Y=te(P,2),H=R(Y);{var Q=j=>{var z=ju();z.__click=[Ou,o,i],ve(j,z)};nt(H,j=>{i()&&i().id&&i().id!==null&&j(Q)})}var Z=te(H,2);Z.__click=[Eu,D,i,o];var G=te(Z,2);return G.__click=[Cu,i,o],K(Y),K(M),At(M,j=>ue(f,j),()=>C(f)),Ke(()=>we(F,`${i()&&i().id&&i().id!==null?"Edit":"Add"} Hunger`)),ve(s,M),ot({close:D,showModal:E})}gt(["click"]);function Ku(s,o,i){o()!==0&&(o(0),i.onchange&&i.onchange(o()))}function Fu(s,o,i){o()!==1&&(o(1),i.onchange&&i.onchange(o()))}var qu=xe('<ul class="svelte-tu3q0a"><li><button type="button">Fasting</button></li> <li><button type="button">Hours</button></li></ul>');function Ru(s,o){rt(o,!0);let i=Te(o,"selected",7,0);var u=qu(),f=R(u),v=R(f);let p;v.__click=[Ku,i,o],K(f);var D=te(f,2),E=R(D);let M;E.__click=[Fu,i,o],K(D),K(u),Ke((A,F)=>{p=Yt(v,1,"fasting svelte-tu3q0a",null,p,A),M=Yt(E,1,"hours svelte-tu3q0a",null,M,F)},[()=>({selected:i()===0}),()=>({selected:i()===1})]),ve(s,u),ot()}gt(["click"]);function Bu(s,o){o()}var Nu=xe('<dialog class="svelte-msa23r"><h3 class="svelte-msa23r">Settings</h3> <article class="svelte-msa23r"><p class="svelte-msa23r">Settings.</p></article> <footer class="svelte-msa23r"><button type="button" class="svelte-msa23r">Done</button></footer></dialog>');function Hu(s,o){rt(o,!0);let i=Ce(void 0);function u(){C(i).close()}function f(){C(i).showModal()}var v=Nu(),p=te(R(v),4),D=R(p);return D.__click=[Bu,u],K(p),K(v),At(v,E=>ue(i,E),()=>C(i)),ve(s,v),ot({close:u,showModal:f})}gt(["click"]);function zu(s,o,i,u){o(),i(null),u.oncancel&&u.oncancel()}function Lu(s,o,i){o.ondelete&&o.ondelete(i().id)}function Uu(s,o,i){o()===null&&o({...o(),volume:8}),i.onsave&&i.onsave(o())}var Yu=(s,o,i)=>o(C(i).value),Wu=xe('<li class="svelte-1sbih0z"><button type="button" class="svelte-1sbih0z"><p class="svelte-1sbih0z"> </p> <p class="svelte-1sbih0z"> </p> <!></button></li>'),Vu=xe('<button class="delete svelte-1sbih0z" type="button">Delete</button>'),Qu=xe('<dialog class="svelte-1sbih0z"><h3 class="svelte-1sbih0z"> </h3> <ul class="svelte-1sbih0z"></ul> <footer class="svelte-1sbih0z"><!> <button class="cancel svelte-1sbih0z" type="button">Cancel</button> <button type="button" class="svelte-1sbih0z">Save</button></footer></dialog>');function Gu(s,o){rt(o,!0);let i=Te(o,"item",7,null),u=Te(o,"units",3,"oz"),f=Ce(void 0),v=Xn([{value:8,label:"Cup"},{value:12,label:"Can"},{value:16,label:"Bottle"},{value:20,label:"Medium"},{value:30,label:"Gatorade"},{value:32,label:"Big Q"},{value:44,label:"QT Large"},{value:52,label:"Extra Large"}]),p=Ve(()=>i()&&i().volume&&i().volume!==null?i().volume:8);function D(z){const q=z;i({...i(),volume:q})}function E(){C(f).close()}function M(){C(f).showModal()}var A=Qu(),F=R(A),P=R(F);K(F);var Y=te(F,2);Ut(Y,21,()=>v,Lt,(z,q)=>{var B=Wu();const W=Ve(()=>C(q).value===C(p)?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");var N=R(B);N.__click=[Yu,D,q];var oe=R(N),he=R(oe,!0);K(oe);var se=te(oe,2),me=R(se);K(se);var Ee=te(se,2);const Fe=Ve(()=>C(q).value===C(p)?"#0284c7":"#161616");lt(Ee,{get color(){return C(Fe)},height:"20",get icon(){return C(W)},width:"20"}),K(N),K(B),Ke(()=>{we(he,C(q).label),we(me,`${C(q).value??""} ${u()??""}`)}),ve(z,B)}),K(Y);var H=te(Y,2),Q=R(H);{var Z=z=>{var q=Vu();q.__click=[Lu,o,i],ve(z,q)};nt(Q,z=>{i()&&i().id&&i().id!==null&&z(Z)})}var G=te(Q,2);G.__click=[zu,E,i,o];var j=te(G,2);return j.__click=[Uu,i,o],K(H),K(A),At(A,z=>ue(f,z),()=>C(f)),Ke(()=>we(P,`${i()&&i().id&&i().id!==null?"Edit":"Add"} Water`)),ve(s,A),ot({close:E,showModal:M})}gt(["click"]);var Xu=xe('<main class="svelte-1p6a8xw"><header class="svelte-1p6a8xw"><span></span> <!> <button type="button" class="svelte-1p6a8xw"><!></button></header> <section class="svelte-1p6a8xw"><article class="svelte-1p6a8xw"><!></article> <article class="svelte-1p6a8xw"><!></article></section></main> <!> <!> <!> <!>',1);function hl(s,o){rt(o,!0);const i=new Ca;let u=0,f=Ce(Xn([])),v=Ce(Xn([])),p=Ce(void 0),D=Ce("started"),E=Ce(null),M=Ce("Started"),A=Ce("Edit Fast Started"),F=Ce(void 0),P=Ce(null),Y=Ce(5),H=Xn([{value:1,label:"Starving"},{value:2,label:"Very hungry"},{value:3,label:"Pretty hungry"},{value:4,label:"Snacky"},{value:5,label:"Satisfied"},{value:6,label:"Slightly full"},{value:7,label:"Uncomfortable"},{value:8,label:"Stuffed"},{value:9,label:"Stomach aches"},{value:10,label:"Sick"}]),Q=Ce(null),Z=Ce(0),G=Ce(void 0),j=Ce(null),z=Ce(0),q=Ce(void 0),B=Ce(null);Jr(()=>{let ae=window.localStorage.getItem("fh_screen");ue(Z,ae===null?0:parseInt(ae),!0),setInterval(()=>{u===60?(N(),u=0):u=u+1,C(j)!==null&&ue(Q,Date.now(),!0)},1e3),se(),N(),he(),me(),oe()});function W(ae){const le=ae.getFullYear(),_e=String(ae.getMonth()+1).padStart(2,"0"),Ge=String(ae.getDate()).padStart(2,"0");return`${le}-${_e}-${Ge}`}function N(ae=7){i.browseHistory().then(le=>{const _e={},Ge=new Date,Pe=new Date(Ge.getFullYear(),Ge.getMonth(),Ge.getDate()),Oe=new Date(Pe);if(Oe.setDate(Pe.getDate()-(ae-1)),!Array.isArray(le)||le.length===0){const qe=new Date(Oe);for(;qe<=Pe;){const Le=W(qe);_e[Le]=Array(24).fill(0),qe.setDate(qe.getDate()+1)}}else{for(const Le of le){const vt=new Date(Le.started),Gt=Le.ended?new Date(Le.ended):new Date,Xt=new Date(vt.getTime());Xt.setSeconds(0,0);const pt=new Date(Gt.getTime());pt.setSeconds(0,0);let ne=new Date(Xt);for(;ne<pt;){const xt=W(ne),yt=new Date(ne.getFullYear(),ne.getMonth(),ne.getDate());if(yt>=Oe&&yt<=Pe){const Jt=ne.getHours();_e[xt]||(_e[xt]=Array(24).fill(0)),_e[xt][Jt]+=1}ne.setMinutes(ne.getMinutes()+1)}}for(const Le in _e)_e[Le]=_e[Le].map(vt=>+(Math.min(vt,60)/60).toFixed(6));const qe=new Date(Oe);for(;qe<=Pe;){const Le=W(qe);_e[Le]||(_e[Le]=Array(24).fill(0)),qe.setDate(qe.getDate()+1)}}const Se=Object.keys(_e).sort((qe,Le)=>Le.localeCompare(qe)),Ie={};for(const qe of Se)Ie[qe]=_e[qe];const Qt=Array(24).fill(0);for(const qe of Array(24).keys())for(const Le of Se)Qt[qe]+=Ie[Le][qe];const Kt=Qt.map(qe=>+(qe/10).toFixed(6));ue(f,{daily:Ie,average:Kt},!0)})}function oe(){i.browseHistory().then(ae=>{let le=null,_e=structuredClone(ae);_e.forEach(Pe=>{Pe.type="start",Pe.timed=new Date(Pe.started.getTime())});let Ge=structuredClone(ae);Ge=Ge.filter(Pe=>Pe.ended!==null),Ge.forEach(Pe=>{Pe.type="end",Pe.timed=new Date(Pe.ended.getTime())}),_e=_e.concat(Ge),le=[..._e],i.browseHunger().then(Pe=>(Pe=Pe.map(Oe=>{const Se=H.find(Ie=>Ie.value===Oe.level);return Oe.level=Se.label,Oe.timed=new Date(Oe.created.getTime()),Oe}),le=le.concat(Pe),i.browseWater())).then(Pe=>{Pe=Pe.map(Se=>(Se.timed=new Date(Se.created.getTime()),Se)),le=le.concat(Pe),le.sort((Se,Ie)=>Se.timed.getTime()<Ie.timed.getTime()?1:Se.timed.getTime()>Ie.timed.getTime()?-1:0);const Oe=[];for(let Se=0;Se<le.length;Se++){const Ie=new Date(le[Se].timed.getTime());Ie.setHours(23),Ie.setMinutes(59),Ie.setSeconds(59),Ie.setMilliseconds(999),Oe.length===0?Oe.push({type:"header",timed:Ie}):(Oe[Oe.length-1].timed.getDate()!==le[Se].timed.getDate()||Oe[Oe.length-1].timed.getMonth()!==le[Se].timed.getMonth()||Oe[Oe.length-1].timed.getFullYear()!==le[Se].timed.getFullYear())&&Oe.push({type:"header",timed:Ie})}le=le.concat(Oe),le.sort((Se,Ie)=>Se.timed.getTime()<Ie.timed.getTime()?1:Se.timed.getTime()>Ie.timed.getTime()?-1:0),ue(v,[...le],!0)})})}function he(){i.browseHunger(!0).then(ae=>{ae===null?ue(Y,5):ue(Y,ae.level,!0)})}function se(){i.browseHistory().then(ae=>{ae.length===0&&(ue(j,null),ue(Q,null)),ae.sort((le,_e)=>le.started.getTime()>_e.started.getTime()?-1:le.started.getTime()<_e.started.getTime()?1:0),ae[0].ended===null&&(ue(j,new Date(ae[0].started.getTime()),!0),ue(Q,Date.now(),!0))})}function me(){i.browseWater(!0).then(ae=>{const le=ae.reduce((_e,Ge)=>_e+Ge.volume,0);ue(z,le,!0)})}function Ee(){ue(j,null),ue(Q,null),i.browseHistoryByEnd().then(ae=>(ae.ended=new Date,i.editHistory(ae))).then(()=>{se(),N(),oe()})}function Fe(){C(F).showModal()}function Ne(){i.addHistory().then(()=>{se(),N(),oe()})}function Re(){C(q).showModal()}function Ue(ae){C(E).started.getTime()===C(j).getTime()&&(ue(j,null),ue(Q,null)),i.deleteHistory(ae).then(()=>{C(p).close(),ue(E,null),se(),N(),oe()})}function ye(ae){i.editHistory(ae).then(()=>{C(p).close(),ue(E,null),se(),N(),oe()})}function ce(ae,le){ae==="start"?(ue(D,"started"),ue(M,"Started"),ue(A,"Edit Fast Started"),i.readHistory(le).then(_e=>{ue(E,{..._e},!0),C(p).showModal()})):ae==="end"?(ue(D,"ended"),ue(M,"Ended"),ue(A,"Edit Fast Ended"),i.readHistory(le).then(_e=>{ue(E,{..._e},!0),C(p).showModal()})):ae==="water"?i.readWater(le).then(_e=>{ue(B,{..._e},!0),C(q).showModal()}):ae==="hunger"&&i.readHunger(le).then(_e=>{ue(P,{..._e},!0),C(F).showModal()})}function Be(ae){i.deleteHunger(ae).then(()=>{C(F).close(),ue(P,null),he(),oe()})}function je(ae){C(P)===null?i.addHunger(ae.level).then(le=>{C(F).close(),he(),oe()}):i.editHunger(ae).then(le=>{C(F).close(),ue(P,null),he(),oe()})}function Ye(ae){C(Z)!==ae&&(window.localStorage.setItem("fh_screen",ae),ue(Z,ae,!0))}function Qe(){C(G).showModal()}function We(ae){i.deleteWater(ae).then(()=>{C(q).close(),ue(B,null),me(),oe()})}function ht(ae){C(B)===null?i.addWater(ae.volume).then(le=>{C(q).close(),me(),oe()}):i.editWater(ae).then(le=>{C(q).close(),ue(B,null),me(),oe()})}var at=Xu(),it=dt(at),ct=R(it),Wt=te(R(ct),2);Ru(Wt,{onchange:Ye,get selected(){return C(Z)}});var ie=te(Wt,2);ie.__click=Qe;var Vt=R(ie);lt(Vt,{height:"20",icon:"material-symbols:settings-outline",width:"20"}),K(ie),K(ct);var mt=te(ct,2),ke=R(mt),Mt=R(ke);Ws(Mt,{get activity(){return C(f)},get hunger(){return C(Y)},get levels(){return H},get now(){return C(Q)},onend:Ee,onhunger:Fe,onsettings:Qe,onstart:Ne,onwater:Re,get started(){return C(j)},get water(){return C(z)}}),K(ke);var wn=te(ke,2),wt=R(wn);Tu(wt,{get activity(){return C(f)},get history(){return C(v)},get levels(){return H},onchange:ce}),K(wn),K(mt),K(it);var xn=te(it,2);At(vu(xn,{get field(){return C(D)},get item(){return C(E)},get label(){return C(M)},ondelete:Ue,onsave:ye,get title(){return C(A)}}),ae=>ue(p,ae,!0),()=>C(p));var kn=te(xn,2);At(Mu(kn,{get item(){return C(P)},get levels(){return H},ondelete:Be,onsave:je}),ae=>ue(F,ae,!0),()=>C(F));var Dn=te(kn,2);At(Gu(Dn,{get item(){return C(B)},ondelete:We,onsave:ht}),ae=>ue(q,ae,!0),()=>C(q));var ar=te(Dn,2);At(Hu(ar,{}),ae=>ue(G,ae,!0),()=>C(G)),Ke(()=>Jn(mt,"data-screen",C(Z)===0?"fasting":"hours")),ve(s,at),ot()}gt(["click"]);export{hl as component};
